<!DOCTYPE html>
<html>
	<head>
		<title>aws.org</title>
		<link rel="stylesheet" href="/diary/resources/css/main.css" />
		<link rel="stylesheet" href="/diary/resources/highlight/styles/default.css" />
		<script src="/diary/resources/js/jquery-3.4.1.min.js"></script>
		<script src="/diary/resources/js/swgen.js"></script>
		<script src="/diary/resources/highlight/highlight.pack.js"></script>
		<script src='https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/latest.js?config=TeX-MML-AM_CHTML' async></script>
		<script>hljs.initHighlightingOnLoad();</script>
	</head>
	<body>
		<nav id='content'>
		</nav>
		<section class="main-article-area">
			<div id='main'>
				<h1 id="ec2">EC2</h1>
<p>Elastic Compute Cloud is the service we can use to create and run VM in the cloud.</p>
<h2 id="term">Term</h2>
<dl class="incremental">
<dt>AMI</dt>
<dd>Amazon Machine Image, pre-configured server templates to launch an instance
</dd>
</dl>
<h1 id="vpc">VPC</h1>
<p>Virtual Private Cloud is a virtual networking layer for Amazon EC2 that enable you to launch AWS resources into a virtual network.</p>
<p>By default, there's already a default VPC for your instances. And we can create our own VPC and subnets.</p>
<p>Feature of EC2-VPC:</p>
<ul class="incremental">
<li>static and persisted private IPv4 addresses to instance</li>
<li>optionally associated an IPv6 CIDE block to VPC</li>
<li>optionally assign IPv6 address to instance</li>
<li>define multiple network interfaces to your instance</li>
<li>manage security group membership</li>
<li>egress/ingress filtering</li>
<li>ACL</li>
<li>run your instance on single-tenant hardware (?)</li>
</ul>
<p>VPC information</p>
<ul class="incremental">
<li>subnet</li>
<li>internet gateway</li>
<li>route table
<ul class="incremental">
<li>main route table (by default)</li>
<li>custom route table</li>
</ul></li>
</ul>
<h2 id="key-concept">Key Concept</h2>
<ul class="incremental">
<li>isolate from other virtual network
<ul class="incremental">
<li>IP address range</li>
<li>subnets
<ul class="incremental">
<li>public subnet that can connect to the internet</li>
<li>private subnet for resources that won't be connected to the internet</li>
</ul></li>
<li>security groups</li>
<li>configure route tables</li>
</ul></li>
</ul>
<h2 id="architecture">Architecture</h2>
<h3 id="default-vpc">Default VPC</h3>
<p>#+CAPTION <img src="./images/default-vpc-diagram.png" /> VPC may span multiple zones and there's a separated subnet in each zone.</p>
<p>Each instance that launch into a default subnet has</p>
<ul class="incremental">
<li>a private IPv4 address</li>
<li>a public IPv4 address</li>
</ul>
<p>These instances can communicate with the internet through the internet gateway.</p>
<h3 id="nondefault-vpc">Nondefault VPC</h3>
<figure>
<img src="./images/nondefault-vpc-diagram.png" alt="" /><figcaption>Nondefault VPC Diagram</figcaption>
</figure>
<ul class="incremental">
<li>Only private IPv4 addresses are assigned</li>
<li>instances can communicate with each other (even across the subnets)</li>
<li>there's no internet gateway been attached to this VPC</li>
</ul>
<ol class="incremental">
<li><p>Enable internet access</p>
<figure>
<img src="./images/internet-gateway-diagram.png" alt="" /><figcaption>Internet gateway Diagram</figcaption>
</figure>
<ol class="incremental">
<li>Attach an internet gateway to this VPC</li>
<li>associate an Elastic IP to the instance</li>
</ol></li>
<li><p>NAT</p>
<p>For the scenario that to allow outbound traffic only by</p>
<ul class="incremental">
<li>create a NAT device (has an Elastic IP address and connects to the internet through an internet gateway)</li>
<li>and map multiple private IPv4 addresses to single IPv4 address</li>
</ul></li>
<li><p><span class="todo TODO">TODO</span> IPv6</p></li>
<li><p><span class="todo TODO">TODO</span> VPN</p></li>
<li><p><span class="todo TODO">TODO</span> PrivateLink</p></li>
</ol>
<h2 id="different-from-traditional-network">Different from traditional network</h2>
<h2 id="vpc-endpoints"><span class="todo TODO">TODO</span> VPC Endpoints</h2>
<h2 id="dns"><span class="todo TODO">TODO</span> DNS</h2>
<h2 id="hardware-tenancy"><span class="todo TODO">TODO</span> Hardware tenancy</h2>
<h2 id="security-group"><span class="todo TODO">TODO</span> Security Group</h2>
<p>Acts as a virtual firewall to control the traffic for its associated instances.</p>
<p>Rules contains:</p>
<ul class="incremental">
<li>inbound rules</li>
<li>outbound rules</li>
</ul>
<p>Associate a security group with an instance when launching the instance.</p>
<p>There's a default security group</p>
<h3 id="inbound-rules">inbound rules</h3>
<p>IP + Protocol + Port Range + Comments</p>
<ul class="incremental">
<li>public IPv4 address range of your home network</li>
</ul>
<ul class="incremental">
<li>Type
<ul class="incremental">
<li>Protocol</li>
<li>Port Range</li>
</ul></li>
<li>Source
<ul class="incremental">
<li>Custom</li>
<li>Anywhere</li>
<li>My IP</li>
</ul></li>
<li>Description</li>
</ul>
<h3 id="outbound-rules">outbound rules</h3>
<h2 id="how-to">How to</h2>
<h3 id="check-the-internet-gateway-info-of-vpc">check the internet gateway info of VPC</h3>
<h3 id="display-the-main-route-table-rules">display the main route table rules</h3>
<h3 id="get-the-custom-route-table-info-of-vpc">get the custom route table info of VPC</h3>
<ul class="incremental">
<li>local route, allow instances to communicate with each other</li>
<li>outside flow</li>
</ul>
<h3 id="check-the-default-security-group">check the default security group</h3>
<h3 id="get-the-subnet-info-of-vpc">get the subnet info of VPC</h3>
<h3 id="describe-vpcs">describe VPCs</h3>
<div class="sourceCode" id="cb1"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb1-1"><a href="#cb1-1"></a><span class="ex">aws</span> ec2 describe-vpcs</span></code></pre></div>
<p>Return list of VPC configurations</p>
<ul class="incremental">
<li>CIDR block</li>
<li>DHCP options set</li>
<li>Tenancy: if allow tenancy of instances launched into the VPC</li>
<li>is default</li>
<li>Owner ID: Aws account</li>
</ul>
<h3 id="expose-service-inside-a-non-default-vpc">expose service inside a non-default VPC</h3>
<ol class="incremental">
<li>create a VPC (specify CIDR)</li>
<li>attach an internet gateway</li>
<li>create subnet (specify subnet's CIDR)</li>
<li>create a custom route table and associate it with the subnet</li>
</ol>
<h3 id="launch-an-instance">launch an instance</h3>
<h3 id="assign-an-elastic-ip-address-to-your-instance">assign an elastic IP address to your instance</h3>
<ul class="incremental">
<li>specify the subnet</li>
</ul>
<ol class="incremental">
<li><p><span class="todo TODO">TODO</span> AMI</p></li>
</ol>
<h2 id="reference">Reference</h2>
<ul class="incremental">
<li><a href="https://docs.aws.amazon.com/vpc/latest/userguide/what-is-amazon-vpc.html">What is Amazon VPC</a></li>
<li><a href="https://docs.aws.amazon.com/vpc/latest/userguide/getting-started-ipv4.html">getting started with IPv4</a></li>
</ul>
<h1 id="ecs">ECS</h1>
<p>Elastic Container Service is the service to run Docker application on a scalable cluster.</p>
<h1 id="landscape">Landscape</h1>
<h2 id="region-and-zone"><span class="todo TODO">TODO</span> Region and Zone</h2>

			</div>
		</section>
	</body>
</html>
