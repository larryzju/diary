
	<!DOCTYPE html>
	<html>
		<head>
			<title>README.org</title>
			<link rel="stylesheet" href="/diary/resources/css/main.css" />
			<script src="/diary/resources/js/jquery-3.4.1.min.js"></script>
			<script src="/diary/resources/js/swgen.js"></script>
		</head>
		<body>
			<nav id='content'>
				<ul><li><details><summary>algorithm</summary><ul><li><details><summary>introduction-to-algorithm</summary><ul><li><a href='/diary/algorithm/introduction-to-algorithm/sort.html'>sort.org</a></li></ul></details></li><li><a href='/diary/algorithm/string-match.html'>string-match.org</a></li></ul></details></li><li><details><summary>blog</summary><ul><li><a href='/diary/blog/rescure-libc-deleted.html'>rescure-libc-deleted.org</a></li><li><a href='/diary/blog/timezone.html'>timezone.org</a></li></ul></details></li><li><details><summary>book</summary><ul><li><a href='/diary/book/git%e6%95%99%e7%a8%8b.html'>git教程.org</a></li><li><a href='/diary/book/go%e8%af%ad%e8%a8%80%e7%bc%96%e7%a8%8b.html'>go语言编程.org</a></li><li><a href='/diary/book/javascript%e5%85%a8%e6%a0%88%e6%95%99%e7%a8%8b.html'>javascript全栈教程.org</a></li><li><a href='/diary/book/rich-dad-and-poor-dad.html'>rich-dad-and-poor-dad.org</a></li><li><a href='/diary/book/%e4%ba%ba%e7%b1%bb%e7%ae%80%e5%8f%b2%e2%80%94%e2%80%94%e4%bb%8e%e5%8a%a8%e7%89%a9%e5%88%b0%e4%b8%8a%e5%b8%9d.html'>人类简史——从动物到上帝.org</a></li><li><details><summary>春秋史话</summary><ul><li><a href='/diary/book/%e6%98%a5%e7%a7%8b%e5%8f%b2%e8%af%9d/%e6%98%a5%e7%a7%8b%e5%8f%b2%e8%af%9d.html'>春秋史话.org</a></li></ul></details></li><li><a href='/diary/book/%e8%9a%8a%e5%ad%90%e5%b9%b2%e5%98%9b%e8%80%81%e5%8f%ae%e6%88%91.html'>蚊子干嘛老叮我.org</a></li></ul></details></li><li><details><summary>cloud</summary><ul><li><a href='/diary/cloud/docker.html'>docker.org</a></li><li><a href='/diary/cloud/gcp.html'>gcp.org</a></li><li><a href='/diary/cloud/gke.html'>gke.org</a></li><li><a href='/diary/cloud/helm.html'>helm.org</a></li><li><details><summary>kubernetes</summary><ul><li><a href='/diary/cloud/kubernetes/README.html'>README.org</a></li><li><a href='/diary/cloud/kubernetes/cloudman.html'>cloudman.org</a></li><li><a href='/diary/cloud/kubernetes/content.html'>content.org</a></li><li><a href='/diary/cloud/kubernetes/controller.html'>controller.org</a></li><li><a href='/diary/cloud/kubernetes/golang.html'>golang.org</a></li><li><a href='/diary/cloud/kubernetes/k8s.html'>k8s.org</a></li><li><a href='/diary/cloud/kubernetes/kubeadm.html'>kubeadm.org</a></li><li><a href='/diary/cloud/kubernetes/kuberbuilder.html'>kuberbuilder.org</a></li><li><a href='/diary/cloud/kubernetes/kubernetes-guide.html'>kubernetes-guide.org</a></li><li><a href='/diary/cloud/kubernetes/operator.html'>operator.org</a></li><li><a href='/diary/cloud/kubernetes/rbac.html'>rbac.org</a></li><li><a href='/diary/cloud/kubernetes/registry.html'>registry.org</a></li><li><a href='/diary/cloud/kubernetes/todo.html'>todo.org</a></li><li><a href='/diary/cloud/kubernetes/tutorial.html'>tutorial.org</a></li><li><a href='/diary/cloud/kubernetes/what-is-container.html'>what-is-container.org</a></li></ul></details></li></ul></details></li><li><details><summary>csapp</summary><ul><li><a href='/diary/csapp/csapp-digest.html'>csapp-digest.org</a></li><li><a href='/diary/csapp/cscpp.html'>cscpp.org</a></li></ul></details></li><li><a href='/diary/docker.html'>docker.org</a></li><li><details><summary>emacs</summary><ul><li><a href='/diary/emacs/orgmode.html'>orgmode.org</a></li></ul></details></li><li><details><summary>history</summary><ul><li><a href='/diary/history/%e5%85%a8%e7%90%83%e9%80%9a%e5%8f%b2.html'>全球通史.org</a></li><li><a href='/diary/history/%e5%8d%97%e5%8c%97%e6%9c%9d.html'>南北朝.org</a></li><li><a href='/diary/history/%e6%99%8b%e5%8f%b2.html'>晋史.org</a></li></ul></details></li><li><a href='/diary/index.html'>index.org</a></li><li><details><summary>linux</summary><ul><li><a href='/diary/linux/centos.html'>centos.org</a></li><li><a href='/diary/linux/filesystem.html'>filesystem.org</a></li><li><a href='/diary/linux/init.d.html'>init.d.org</a></li><li><a href='/diary/linux/iptables.html'>iptables.org</a></li><li><a href='/diary/linux/linuxcast.html'>linuxcast.org</a></li><li><a href='/diary/linux/ss.html'>ss.org</a></li><li><a href='/diary/linux/suse.html'>suse.org</a></li><li><a href='/diary/linux/vps.html'>vps.org</a></li></ul></details></li><li><details><summary>literal</summary><ul><li><a href='/diary/literal/book.html'>book.org</a></li><li><a href='/diary/literal/han.html'>han.org</a></li><li><a href='/diary/literal/movie.html'>movie.org</a></li><li><a href='/diary/literal/nounce.html'>nounce.org</a></li><li><a href='/diary/literal/person.html'>person.org</a></li><li><a href='/diary/literal/%e5%9f%ba%e7%9d%a3%e5%b1%b1%e4%bc%af%e7%88%b5.html'>基督山伯爵.org</a></li></ul></details></li><li><details><summary>math</summary><ul><li><a href='/diary/math/%e6%a6%82%e7%8e%87%e8%ae%ba%e4%b8%8e%e6%95%b0%e7%90%86%e7%bb%9f%e8%ae%a1.html'>概率论与数理统计.org</a></li></ul></details></li><li><a href='/diary/mindmap.html'>mindmap.org</a></li><li><details><summary>misc</summary><ul><li><a href='/diary/misc/org-usage.html'>org-usage.org</a></li><li><a href='/diary/misc/screen.html'>screen.org</a></li></ul></details></li><li><details><summary>network</summary><ul><li><a href='/diary/network/ssl.html'>ssl.org</a></li></ul></details></li><li><a href='/diary/opengl.html'>opengl.org</a></li><li><a href='/diary/orgmode.html'>orgmode.org</a></li><li><details><summary>os</summary><ul><li><a href='/diary/os/80386.html'>80386.org</a></li><li><a href='/diary/os/8259a.html'>8259a.org</a></li><li><a href='/diary/os/boot.html'>boot.org</a></li><li><a href='/diary/os/gcc-inline-asm.html'>gcc-inline-asm.md</a></li><li><a href='/diary/os/linux.html'>linux.org</a></li></ul></details></li><li><details><summary>policy</summary><ul><li><a href='/diary/policy/%e5%85%a8%e7%90%83%e5%8c%96%e6%b3%a2%e6%8a%98%e4%b8%8e%e6%b0%91%e8%90%a5%e7%bb%8f%e6%b5%8e%e7%9a%84%e6%9c%aa%e6%9d%a5_%e5%91%a8%e5%85%b6%e4%bb%81.html'>全球化波折与民营经济的未来_周其仁.org</a></li></ul></details></li><li><details><summary>programming</summary><ul><li><details><summary>algorithm</summary><ul><li><details><summary>algorithm4th</summary><ul><li><a href='/diary/programming/algorithm/algorithm4th/algorithm.html'>algorithm.org</a></li></ul></details></li><li><a href='/diary/programming/algorithm/%e5%b0%8f%e7%94%b2%e9%b1%bc-%e6%95%b0%e6%8d%ae%e7%bb%93%e6%9e%84%e4%b8%8e%e7%ae%97%e6%b3%95-%e8%a7%86%e9%a2%91%e7%ac%94%e8%ae%b0.html'>小甲鱼-数据结构与算法-视频笔记.org</a></li></ul></details></li><li><details><summary>clojure</summary><ul><li><a href='/diary/programming/clojure/clojure.tools.logging.html'>clojure.tools.logging.md</a></li></ul></details></li><li><details><summary>cpp</summary><ul><li><a href='/diary/programming/cpp/tutorials.html'>tutorials.org</a></li></ul></details></li><li><details><summary>elasticsearch</summary><ul><li><a href='/diary/programming/elasticsearch/elasticsearch-definitive-guide-note.html'>elasticsearch-definitive-guide-note.org</a></li></ul></details></li><li><details><summary>git</summary><ul><li><a href='/diary/programming/git/git.html'>git.org</a></li></ul></details></li><li><details><summary>golang</summary><ul><li><a href='/diary/programming/golang/cmd.html'>cmd.org</a></li><li><a href='/diary/programming/golang/effective-go.html'>effective-go.org</a></li><li><a href='/diary/programming/golang/go-concurrency.html'>go-concurrency.org</a></li><li><a href='/diary/programming/golang/how-to-write-go-code.html'>how-to-write-go-code.org</a></li><li><a href='/diary/programming/golang/json.html'>json.org</a></li><li><details><summary>learn-go-note</summary><ul><li><a href='/diary/programming/golang/learn-go-note/learning-go.html'>learning-go.org</a></li></ul></details></li><li><a href='/diary/programming/golang/library.html'>library.org</a></li><li><a href='/diary/programming/golang/misc.html'>misc.org</a></li><li><a href='/diary/programming/golang/reflect.html'>reflect.org</a></li><li><a href='/diary/programming/golang/template.html'>template.org</a></li><li><a href='/diary/programming/golang/the-little-go-book.html'>the-little-go-book.org</a></li><li><a href='/diary/programming/golang/%e6%97%a0%e9%97%bb%e8%a7%86%e9%a2%91%e7%ac%94%e8%ae%b0.html'>无闻视频笔记.org</a></li></ul></details></li><li><details><summary>hadoop</summary><ul><li><a href='/diary/programming/hadoop/hdfs-permission-guide-note.html'>hdfs-permission-guide-note.org</a></li></ul></details></li><li><details><summary>java</summary><ul><li><a href='/diary/programming/java/derby.html'>derby.org</a></li><li><a href='/diary/programming/java/ivy-vs-maven.html'>ivy-vs-maven.org</a></li><li><a href='/diary/programming/java/java-note.html'>java-note.org</a></li><li><a href='/diary/programming/java/maven.html'>maven.org</a></li><li><a href='/diary/programming/java/servlet.html'>servlet.org</a></li><li><a href='/diary/programming/java/thing-java.html'>thing-java.org</a></li><li><a href='/diary/programming/java/%e6%b7%b1%e5%85%a5%e7%90%86%e8%a7%a3java%e8%99%9a%e6%8b%9f%e6%9c%ba.html'>深入理解java虚拟机.org</a></li></ul></details></li><li><details><summary>javascript</summary><ul><li><a href='/diary/programming/javascript/angularjs.html'>angularjs.org</a></li><li><a href='/diary/programming/javascript/dom.html'>dom.org</a></li></ul></details></li><li><a href='/diary/programming/javascript.html'>javascript.org</a></li><li><details><summary>lisp</summary><ul><li><a href='/diary/programming/lisp/the-little-schemer.html'>the-little-schemer.org</a></li></ul></details></li><li><details><summary>python</summary><ul><li><a href='/diary/programming/python/asyncio.html'>asyncio.org</a></li><li><a href='/diary/programming/python/flask.html'>flask.org</a></li><li><a href='/diary/programming/python/idiomatic-python-note.html'>idiomatic-python-note.org</a></li><li><a href='/diary/programming/python/jinja2.html'>jinja2.org</a></li><li><a href='/diary/programming/python/package-manage.html'>package-manage.org</a></li><li><a href='/diary/programming/python/pygame.html'>pygame.org</a></li><li><a href='/diary/programming/python/tools.html'>tools.org</a></li></ul></details></li><li><details><summary>scala</summary><ul><li><a href='/diary/programming/scala/programming-in-scala.html'>programming-in-scala.org</a></li><li><a href='/diary/programming/scala/scala.html'>scala.org</a></li><li><a href='/diary/programming/scala/scalikeJDBC.html'>scalikeJDBC.org</a></li></ul></details></li><li><a href='/diary/programming/storm.html'>storm.org</a></li><li><a href='/diary/programming/thrift.html'>thrift.org</a></li><li><a href='/diary/programming/typescript.html'>typescript.org</a></li><li><details><summary>web</summary><ul><li><a href='/diary/programming/web/liquid.html'>liquid.org</a></li></ul></details></li></ul></details></li><li><details><summary>rdbms</summary><ul><li><a href='/diary/rdbms/rdbms.html'>rdbms.org</a></li></ul></details></li><li><details><summary>resource</summary><ul><li><a href='/diary/resource/emacs.html'>emacs.md</a></li><li><a href='/diary/resource/ml-resource.html'>ml-resource.md</a></li><li><a href='/diary/resource/nlp-resource.html'>nlp-resource.md</a></li></ul></details></li><li><details><summary>services</summary><ul><li><details><summary>mail</summary><ul><li><a href='/diary/services/mail/mail.html'>mail.org</a></li></ul></details></li></ul></details></li><li><details><summary>subtitle</summary><ul><li><a href='/diary/subtitle/docker.html'>docker.org</a></li></ul></details></li><li><details><summary>toarous</summary><ul><li><a href='/diary/toarous/README.html'>README.md</a></li><li><a href='/diary/toarous/idt.html'>idt.md</a></li><li><a href='/diary/toarous/intel.html'>intel.org</a></li><li><a href='/diary/toarous/notes.html'>notes.org</a></li><li><a href='/diary/toarous/osx-environment.html'>osx-environment.org</a></li><li><a href='/diary/toarous/vga.html'>vga.md</a></li></ul></details></li><li><details><summary>tools</summary><ul><li><a href='/diary/tools/GCP.html'>GCP.org</a></li><li><a href='/diary/tools/ansible.html'>ansible.org</a></li><li><a href='/diary/tools/bash.html'>bash.org</a></li><li><a href='/diary/tools/gerrit.html'>gerrit.org</a></li><li><a href='/diary/tools/git.html'>git.org</a></li><li><a href='/diary/tools/gpg.html'>gpg.org</a></li><li><a href='/diary/tools/markdown.html'>markdown.org</a></li><li><a href='/diary/tools/nginx.html'>nginx.org</a></li><li><a href='/diary/tools/rpm.html'>rpm.org</a></li><li><a href='/diary/tools/spark.html'>spark.org</a></li><li><a href='/diary/tools/tmux.html'>tmux.org</a></li></ul></details></li><li><details><summary>ui</summary><ul><li><a href='/diary/ui/react.html'>react.org</a></li><li><a href='/diary/ui/tk.html'>tk.org</a></li></ul></details></li><li><details><summary>web</summary><ul><li><a href='/diary/web/chrome-extension.html'>chrome-extension.org</a></li></ul></details></li><li><a href='/diary/words.html'>words.org</a></li><li><a href='/diary/%e7%bd%91%e6%b0%91%e7%9a%84%e7%8b%82%e6%ac%a2.html'>网民的狂欢.org</a></li></ul>
			</nav>
			<section class="main-article-area">
				<div id='main'>
					<h1 id="components">Components</h1>
<p>Split into <strong>master</strong> and <strong>node</strong> host depend on their functionality</p>
<h2 id="master-components">master components</h2>
<ul class="incremental">
<li>api server (restful service)</li>
<li>etcd (zookeeper like k/v storage)</li>
<li>controller manager (update resource object in etcd)</li>
<li>scheduler (which node to create pod)</li>
</ul>
<h2 id="node-components">node components</h2>
<ul class="incremental">
<li>kubelet (client for master)</li>
<li>kube-proxy (to implement pod network)</li>
<li>docker daemon (run container, <code>dockerd</code>)</li>
</ul>
<h1 id="resource-object">Resource Object</h1>
<p>Resource objects are stored in <code>etcd</code> database. And kubernetes is responsible for maintain the status to match the specification of the object.</p>
<h2 id="node">Node</h2>
<p>A worker machine in Kubernetes and is managed by the master components.</p>
<h3 id="status">Status</h3>
<dl class="incremental">
<dt>Address</dt>
<dd>host name, internal IP, external IP, internal DNS, etc
</dd>
<dt>Condition</dt>
<dd>latest resource health status (Ready, memory, pid, disk, network unavailable)
</dd>
<dt>Capacity</dt>
<dd>maximum number of pods can be scheduled, memory, ephemeral-storage
</dd>
<dt>Info</dt>
<dd>nodeInfo
</dd>
</dl>
<p>If the Status of the <strong>Ready</strong> condition remains <strong>Unknown</strong> or <strong>False</strong> for longer than the <strong>pod-eviction-timeout</strong> (5min by default), an argument is passed to the kube-controller-manager and all the Pods on the node are scheduled for deletion by the Node Controller.</p>
<p>The node is not managued by Kubernetes but the cloud providers. It's just a representation.</p>
<h2 id="pod">Pod</h2>
<ul class="incremental">
<li>Logical host (contains multiple containers)</li>
<li>allow containers visit each other (share PID, net, IPC, UTS, Volume)</li>
<li>Has its own IP address</li>
<li>Pod's name is used as addresss</li>
</ul>
<h2 id="label">Label</h2>
<p>Use to select</p>
<h2 id="annotation">Annotation</h2>
<p>Similar to Label, but contains opaque data</p>
<h2 id="namespace">Namespace</h2>
<p>isolate resources</p>
<h2 id="pv-pvc">PV &amp; PVC</h2>
<p>PV 之与 PVC 类似于 Golang 中的 Array 之与 Slice，Pod 之于 node resource</p>
<ul class="incremental">
<li>PV 对应于云运营商提供底层存储；PVC 相当于 Volume，可以被挂载到期 Pod 中</li>
<li>PVC 与 PV 一一对应，不存在一个 PV 对应多个 PVC 的情况，也不存在一个 PVC 跨越多个 PV 的情况</li>
<li>PV 中的 ClaimRef 反向引用 PVC, PVC 中 VolumeName 引用 PV</li>
</ul>
<h3 id="access-mode">Access Mode</h3>
<p>Both PV and PVC can be configured as subset access mode supported by the resource provider.</p>
<p>The access mode are:</p>
<ul class="incremental">
<li>ReadWriteOnce</li>
<li>ReadWriteMany</li>
<li>ReadOnlyMany</li>
</ul>
<h2 id="job">Job</h2>
<h3 id="reference">Reference</h3>
<ul class="incremental">
<li><a href="https://kubernetes.io/docs/tasks/job/parallel-processing-expansion/">Parallel Processing using Expansions</a></li>
<li><a href="https://kubernetes.io/docs/tasks/job/coarse-parallel-processing-work-queue/">Coarse Parallel Processing Using a Work Queue</a></li>
<li><a href="https://kubernetes.io/docs/tasks/job/fine-parallel-processing-work-queue/">Fine Parallel Processing Using a Work Queue</a></li>
</ul>
<h2 id="volume">Volume</h2>
<ul class="incremental">
<li>Has the same lifespan with Pod</li>
<li>Shared by multiple containers</li>
<li>Has multiple implmenet, for example <code>hostPath</code></li>
</ul>
<h2 id="service">Service</h2>
<ul class="incremental">
<li>binding to selected endpoints (pods)</li>
<li>used to be accessed by external application, with <code>NodePort</code> or <code>LoadBalancer</code> configuraitons</li>
</ul>
<h2 id="replication-controller">Replication Controller</h2>
<ul class="incremental">
<li>manage Pod replications</li>
<li>can be used to scale or rolling update pods' containers</li>
</ul>
<h1 id="custom-resource">custom resource</h1>
<p>Extend kubernetes object type by definiting new resource object.</p>
<p>There're two methods to define custom resource:</p>
<ol class="incremental">
<li>CRD (Custom Resource Definition)</li>
<li>Aggregated API</li>
</ol>
<p>CR should be combined with Custom Controller to maintain the desire object states.</p>
<h2 id="cr-is-a-type-of-things-or-a-single-object"><span class="todo TODO">TODO</span> CR is a type of things? or a single object</h2>
<h2 id="k8s-api-convention-.spec-.status-.metadata"><span class="todo TODO">TODO</span> k8s API convention: <code>.spec</code>, <code>.status</code>, <code>.metadata</code></h2>
<h2 id="operator-pattern"><span class="todo TODO">TODO</span> Operator Pattern?</h2>
<h2 id="declarative-api-vs-imperative-api"><span class="todo TODO">TODO</span> declarative API vs imperative API</h2>
<h1 id="custom-controller">Custom Controller</h1>
<h1 id="customresourcedefinition">CustomResourceDefinition</h1>
<p>API to define new custom resources.</p>
<h2 id="note">Note</h2>
<ul class="incremental">
<li>define the group, version, name</li>
<li>can store any arbitary shaped objects</li>
<li>with <code>OpenAPIV3Schema</code> extension to constrain schema</li>
</ul>
<h2 id="how-to-combine-with-custom-controller"><span class="todo TODO">TODO</span> How to combine with Custom Controller?</h2>
<h2 id="scoped-but-not-namespaced"><span class="todo TODO">TODO</span> scoped but not namespaced?</h2>
<h1 id="operator">Operator</h1>
<p>An application-specific controller that extend Kubernetes API to create configure, and manage instances of complex stateful applications on behalf of a kubernetes user.</p>
<h2 id="what-is-operator"><span class="todo TODO">TODO</span> What is Operator?</h2>
<p>Implement of custom resource and its custom controller and will be built into docker image and deployed as a Deployment.</p>
<h1 id="kubernetes-object">Kubernetes Object</h1>
<h2 id="stored-in-etcd"><span class="todo TODO">TODO</span> stored in etcd?</h2>
<h2 id="basic-fields">basic fields</h2>
<ul class="incremental">
<li>apiVersion</li>
<li>kind</li>
<li>metadata
<ul class="incremental">
<li>name</li>
<li>UID</li>
<li>namespaces</li>
</ul></li>
<li>spec: desired status</li>
<li>status: actual status</li>
</ul>
<h2 id="control-plane-activate-manage"><span class="todo TODO">TODO</span> Control Plane activate manage?</h2>
<p>manage is equal to controller?</p>
<h1 id="namespace-1">Namespace</h1>
<h2 id="resource-quota"><span class="todo TODO">TODO</span> resource quota</h2>
<h2 id="non-namespaced-objects">Non-namespaced Objects</h2>
<ul class="incremental">
<li>use <code>api-resources</code> to check non-namespaced objects</li>
<li>for example, node, PV not in namespaces</li>
</ul>
<h1 id="question">Question</h1>
<h2 id="node-controller"><span class="todo TODO">TODO</span> Node controller</h2>
<div style="white-space: pre-line;">In versions of Kubernetes prior to 1.5, the node controller would
force delete these unreachable pods from the apiserver. However, in
1.5 and higher, the node controller does not force delete pods until
it is confirmed that they have stopped running in the cluster. You can
see the pods that might be running on an unreachable node as being in
the Terminating or Unknown state.</div>
<p>Is node controller running on master node?</p>

				</div>
			</section>
		</body>
	</html>
	