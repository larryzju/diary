
	<!DOCTYPE html>
	<html>
		<head>
			<title>kubernetes-guide.org</title>
			<link rel="stylesheet" href="/diary/resources/css/main.css" />
			<script src="/diary/resources/js/jquery-3.4.1.min.js"></script>
			<script src="/diary/resources/js/swgen.js"></script>
		</head>
		<body>
			<nav id='content'>
				<ul><li><details><summary>algorithm</summary><ul><li><details><summary>introduction-to-algorithm</summary><ul><li><a href='/diary/algorithm/introduction-to-algorithm/sort.html'>sort.org</a></li></ul></details></li><li><a href='/diary/algorithm/string-match.html'>string-match.org</a></li></ul></details></li><li><details><summary>blog</summary><ul><li><a href='/diary/blog/rescure-libc-deleted.html'>rescure-libc-deleted.org</a></li><li><a href='/diary/blog/timezone.html'>timezone.org</a></li></ul></details></li><li><details><summary>book</summary><ul><li><a href='/diary/book/git%e6%95%99%e7%a8%8b.html'>git教程.org</a></li><li><a href='/diary/book/go%e8%af%ad%e8%a8%80%e7%bc%96%e7%a8%8b.html'>go语言编程.org</a></li><li><a href='/diary/book/javascript%e5%85%a8%e6%a0%88%e6%95%99%e7%a8%8b.html'>javascript全栈教程.org</a></li><li><a href='/diary/book/rich-dad-and-poor-dad.html'>rich-dad-and-poor-dad.org</a></li><li><a href='/diary/book/%e4%ba%ba%e7%b1%bb%e7%ae%80%e5%8f%b2%e2%80%94%e2%80%94%e4%bb%8e%e5%8a%a8%e7%89%a9%e5%88%b0%e4%b8%8a%e5%b8%9d.html'>人类简史——从动物到上帝.org</a></li><li><details><summary>春秋史话</summary><ul><li><a href='/diary/book/%e6%98%a5%e7%a7%8b%e5%8f%b2%e8%af%9d/%e6%98%a5%e7%a7%8b%e5%8f%b2%e8%af%9d.html'>春秋史话.org</a></li></ul></details></li><li><a href='/diary/book/%e8%9a%8a%e5%ad%90%e5%b9%b2%e5%98%9b%e8%80%81%e5%8f%ae%e6%88%91.html'>蚊子干嘛老叮我.org</a></li></ul></details></li><li><details><summary>cloud</summary><ul><li><a href='/diary/cloud/docker.html'>docker.org</a></li><li><a href='/diary/cloud/gcp.html'>gcp.org</a></li><li><a href='/diary/cloud/gke.html'>gke.org</a></li><li><a href='/diary/cloud/helm.html'>helm.org</a></li><li><details><summary>kubernetes</summary><ul><li><a href='/diary/cloud/kubernetes/README.html'>README.org</a></li><li><a href='/diary/cloud/kubernetes/cloudman.html'>cloudman.org</a></li><li><a href='/diary/cloud/kubernetes/content.html'>content.org</a></li><li><a href='/diary/cloud/kubernetes/controller.html'>controller.org</a></li><li><a href='/diary/cloud/kubernetes/golang.html'>golang.org</a></li><li><a href='/diary/cloud/kubernetes/k8s.html'>k8s.org</a></li><li><a href='/diary/cloud/kubernetes/kubeadm.html'>kubeadm.org</a></li><li><a href='/diary/cloud/kubernetes/kuberbuilder.html'>kuberbuilder.org</a></li><li><a href='/diary/cloud/kubernetes/kubernetes-guide.html'>kubernetes-guide.org</a></li><li><a href='/diary/cloud/kubernetes/operator.html'>operator.org</a></li><li><a href='/diary/cloud/kubernetes/rbac.html'>rbac.org</a></li><li><a href='/diary/cloud/kubernetes/registry.html'>registry.org</a></li><li><a href='/diary/cloud/kubernetes/todo.html'>todo.org</a></li><li><a href='/diary/cloud/kubernetes/tutorial.html'>tutorial.org</a></li><li><a href='/diary/cloud/kubernetes/what-is-container.html'>what-is-container.org</a></li></ul></details></li></ul></details></li><li><details><summary>csapp</summary><ul><li><a href='/diary/csapp/csapp-digest.html'>csapp-digest.org</a></li><li><a href='/diary/csapp/cscpp.html'>cscpp.org</a></li></ul></details></li><li><a href='/diary/docker.html'>docker.org</a></li><li><details><summary>emacs</summary><ul><li><a href='/diary/emacs/orgmode.html'>orgmode.org</a></li></ul></details></li><li><details><summary>history</summary><ul><li><a href='/diary/history/%e5%85%a8%e7%90%83%e9%80%9a%e5%8f%b2.html'>全球通史.org</a></li><li><a href='/diary/history/%e5%8d%97%e5%8c%97%e6%9c%9d.html'>南北朝.org</a></li><li><a href='/diary/history/%e6%99%8b%e5%8f%b2.html'>晋史.org</a></li></ul></details></li><li><a href='/diary/index.html'>index.org</a></li><li><details><summary>linux</summary><ul><li><a href='/diary/linux/centos.html'>centos.org</a></li><li><a href='/diary/linux/filesystem.html'>filesystem.org</a></li><li><a href='/diary/linux/init.d.html'>init.d.org</a></li><li><a href='/diary/linux/iptables.html'>iptables.org</a></li><li><a href='/diary/linux/linuxcast.html'>linuxcast.org</a></li><li><a href='/diary/linux/ss.html'>ss.org</a></li><li><a href='/diary/linux/suse.html'>suse.org</a></li><li><a href='/diary/linux/vps.html'>vps.org</a></li></ul></details></li><li><details><summary>literal</summary><ul><li><a href='/diary/literal/book.html'>book.org</a></li><li><a href='/diary/literal/han.html'>han.org</a></li><li><a href='/diary/literal/movie.html'>movie.org</a></li><li><a href='/diary/literal/nounce.html'>nounce.org</a></li><li><a href='/diary/literal/person.html'>person.org</a></li><li><a href='/diary/literal/%e5%9f%ba%e7%9d%a3%e5%b1%b1%e4%bc%af%e7%88%b5.html'>基督山伯爵.org</a></li></ul></details></li><li><details><summary>math</summary><ul><li><a href='/diary/math/%e6%a6%82%e7%8e%87%e8%ae%ba%e4%b8%8e%e6%95%b0%e7%90%86%e7%bb%9f%e8%ae%a1.html'>概率论与数理统计.org</a></li></ul></details></li><li><a href='/diary/mindmap.html'>mindmap.org</a></li><li><details><summary>misc</summary><ul><li><a href='/diary/misc/org-usage.html'>org-usage.org</a></li><li><a href='/diary/misc/screen.html'>screen.org</a></li></ul></details></li><li><details><summary>network</summary><ul><li><a href='/diary/network/ssl.html'>ssl.org</a></li></ul></details></li><li><a href='/diary/opengl.html'>opengl.org</a></li><li><a href='/diary/orgmode.html'>orgmode.org</a></li><li><details><summary>os</summary><ul><li><a href='/diary/os/80386.html'>80386.org</a></li><li><a href='/diary/os/8259a.html'>8259a.org</a></li><li><a href='/diary/os/boot.html'>boot.org</a></li><li><a href='/diary/os/gcc-inline-asm.html'>gcc-inline-asm.md</a></li><li><a href='/diary/os/linux.html'>linux.org</a></li></ul></details></li><li><details><summary>policy</summary><ul><li><a href='/diary/policy/%e5%85%a8%e7%90%83%e5%8c%96%e6%b3%a2%e6%8a%98%e4%b8%8e%e6%b0%91%e8%90%a5%e7%bb%8f%e6%b5%8e%e7%9a%84%e6%9c%aa%e6%9d%a5_%e5%91%a8%e5%85%b6%e4%bb%81.html'>全球化波折与民营经济的未来_周其仁.org</a></li></ul></details></li><li><details><summary>programming</summary><ul><li><details><summary>algorithm</summary><ul><li><details><summary>algorithm4th</summary><ul><li><a href='/diary/programming/algorithm/algorithm4th/algorithm.html'>algorithm.org</a></li></ul></details></li><li><a href='/diary/programming/algorithm/%e5%b0%8f%e7%94%b2%e9%b1%bc-%e6%95%b0%e6%8d%ae%e7%bb%93%e6%9e%84%e4%b8%8e%e7%ae%97%e6%b3%95-%e8%a7%86%e9%a2%91%e7%ac%94%e8%ae%b0.html'>小甲鱼-数据结构与算法-视频笔记.org</a></li></ul></details></li><li><details><summary>clojure</summary><ul><li><a href='/diary/programming/clojure/clojure.tools.logging.html'>clojure.tools.logging.md</a></li></ul></details></li><li><details><summary>cpp</summary><ul><li><a href='/diary/programming/cpp/tutorials.html'>tutorials.org</a></li></ul></details></li><li><details><summary>elasticsearch</summary><ul><li><a href='/diary/programming/elasticsearch/elasticsearch-definitive-guide-note.html'>elasticsearch-definitive-guide-note.org</a></li></ul></details></li><li><details><summary>git</summary><ul><li><a href='/diary/programming/git/git.html'>git.org</a></li></ul></details></li><li><details><summary>golang</summary><ul><li><a href='/diary/programming/golang/cmd.html'>cmd.org</a></li><li><a href='/diary/programming/golang/effective-go.html'>effective-go.org</a></li><li><a href='/diary/programming/golang/go-concurrency.html'>go-concurrency.org</a></li><li><a href='/diary/programming/golang/how-to-write-go-code.html'>how-to-write-go-code.org</a></li><li><a href='/diary/programming/golang/json.html'>json.org</a></li><li><details><summary>learn-go-note</summary><ul><li><a href='/diary/programming/golang/learn-go-note/learning-go.html'>learning-go.org</a></li></ul></details></li><li><a href='/diary/programming/golang/library.html'>library.org</a></li><li><a href='/diary/programming/golang/misc.html'>misc.org</a></li><li><a href='/diary/programming/golang/reflect.html'>reflect.org</a></li><li><a href='/diary/programming/golang/template.html'>template.org</a></li><li><a href='/diary/programming/golang/the-little-go-book.html'>the-little-go-book.org</a></li><li><a href='/diary/programming/golang/%e6%97%a0%e9%97%bb%e8%a7%86%e9%a2%91%e7%ac%94%e8%ae%b0.html'>无闻视频笔记.org</a></li></ul></details></li><li><details><summary>hadoop</summary><ul><li><a href='/diary/programming/hadoop/hdfs-permission-guide-note.html'>hdfs-permission-guide-note.org</a></li></ul></details></li><li><details><summary>java</summary><ul><li><a href='/diary/programming/java/derby.html'>derby.org</a></li><li><a href='/diary/programming/java/ivy-vs-maven.html'>ivy-vs-maven.org</a></li><li><a href='/diary/programming/java/java-note.html'>java-note.org</a></li><li><a href='/diary/programming/java/maven.html'>maven.org</a></li><li><a href='/diary/programming/java/servlet.html'>servlet.org</a></li><li><a href='/diary/programming/java/thing-java.html'>thing-java.org</a></li><li><a href='/diary/programming/java/%e6%b7%b1%e5%85%a5%e7%90%86%e8%a7%a3java%e8%99%9a%e6%8b%9f%e6%9c%ba.html'>深入理解java虚拟机.org</a></li></ul></details></li><li><details><summary>javascript</summary><ul><li><a href='/diary/programming/javascript/angularjs.html'>angularjs.org</a></li><li><a href='/diary/programming/javascript/dom.html'>dom.org</a></li></ul></details></li><li><a href='/diary/programming/javascript.html'>javascript.org</a></li><li><details><summary>lisp</summary><ul><li><a href='/diary/programming/lisp/the-little-schemer.html'>the-little-schemer.org</a></li></ul></details></li><li><details><summary>python</summary><ul><li><a href='/diary/programming/python/asyncio.html'>asyncio.org</a></li><li><a href='/diary/programming/python/flask.html'>flask.org</a></li><li><a href='/diary/programming/python/idiomatic-python-note.html'>idiomatic-python-note.org</a></li><li><a href='/diary/programming/python/jinja2.html'>jinja2.org</a></li><li><a href='/diary/programming/python/package-manage.html'>package-manage.org</a></li><li><a href='/diary/programming/python/pygame.html'>pygame.org</a></li><li><a href='/diary/programming/python/tools.html'>tools.org</a></li></ul></details></li><li><details><summary>scala</summary><ul><li><a href='/diary/programming/scala/programming-in-scala.html'>programming-in-scala.org</a></li><li><a href='/diary/programming/scala/scala.html'>scala.org</a></li><li><a href='/diary/programming/scala/scalikeJDBC.html'>scalikeJDBC.org</a></li></ul></details></li><li><a href='/diary/programming/storm.html'>storm.org</a></li><li><a href='/diary/programming/thrift.html'>thrift.org</a></li><li><a href='/diary/programming/typescript.html'>typescript.org</a></li><li><details><summary>web</summary><ul><li><a href='/diary/programming/web/liquid.html'>liquid.org</a></li></ul></details></li></ul></details></li><li><details><summary>rdbms</summary><ul><li><a href='/diary/rdbms/rdbms.html'>rdbms.org</a></li></ul></details></li><li><details><summary>resource</summary><ul><li><a href='/diary/resource/emacs.html'>emacs.md</a></li><li><a href='/diary/resource/ml-resource.html'>ml-resource.md</a></li><li><a href='/diary/resource/nlp-resource.html'>nlp-resource.md</a></li></ul></details></li><li><details><summary>services</summary><ul><li><details><summary>mail</summary><ul><li><a href='/diary/services/mail/mail.html'>mail.org</a></li></ul></details></li></ul></details></li><li><details><summary>subtitle</summary><ul><li><a href='/diary/subtitle/docker.html'>docker.org</a></li></ul></details></li><li><details><summary>toarous</summary><ul><li><a href='/diary/toarous/README.html'>README.md</a></li><li><a href='/diary/toarous/idt.html'>idt.md</a></li><li><a href='/diary/toarous/intel.html'>intel.org</a></li><li><a href='/diary/toarous/notes.html'>notes.org</a></li><li><a href='/diary/toarous/osx-environment.html'>osx-environment.org</a></li><li><a href='/diary/toarous/vga.html'>vga.md</a></li></ul></details></li><li><details><summary>tools</summary><ul><li><a href='/diary/tools/GCP.html'>GCP.org</a></li><li><a href='/diary/tools/ansible.html'>ansible.org</a></li><li><a href='/diary/tools/bash.html'>bash.org</a></li><li><a href='/diary/tools/gerrit.html'>gerrit.org</a></li><li><a href='/diary/tools/git.html'>git.org</a></li><li><a href='/diary/tools/gpg.html'>gpg.org</a></li><li><a href='/diary/tools/markdown.html'>markdown.org</a></li><li><a href='/diary/tools/nginx.html'>nginx.org</a></li><li><a href='/diary/tools/rpm.html'>rpm.org</a></li><li><a href='/diary/tools/spark.html'>spark.org</a></li><li><a href='/diary/tools/tmux.html'>tmux.org</a></li></ul></details></li><li><details><summary>ui</summary><ul><li><a href='/diary/ui/react.html'>react.org</a></li><li><a href='/diary/ui/tk.html'>tk.org</a></li></ul></details></li><li><details><summary>web</summary><ul><li><a href='/diary/web/chrome-extension.html'>chrome-extension.org</a></li></ul></details></li><li><a href='/diary/words.html'>words.org</a></li><li><a href='/diary/%e7%bd%91%e6%b0%91%e7%9a%84%e7%8b%82%e6%ac%a2.html'>网民的狂欢.org</a></li></ul>
			</nav>
			<section class="main-article-area">
				<div id='main'>
					<h1 id="kubernetes-入门">Kubernetes 入门</h1>
<h2 id="kubernetes-是什么"><span class="todo TODO">TODO</span> Kubernetes 是什么</h2>
<h2 id="为什么要用-kubernetes">为什么要用 Kubernetes</h2>
<ol class="incremental">
<li>集成形成复杂系统，节约运维成本</li>
<li>微服务，内置负载均衡</li>
<li>屏弊底层平台和硬件，可迁移往公有云</li>
<li>水平扩展</li>
</ol>
<h2 id="从一个不简单的-hello-world-例子说起">从一个不简单的 Hello World 例子说起</h2>
<h3 id="基本架构">基本架构</h3>
<ol class="incremental">
<li>fronted (replica x 3)，由 PHP 读 redis-slave 和 写 redis-master 功能</li>
<li>redis-master，写入页面提交</li>
<li>redis-slave (replica x 2)，同步 redis-master，提供读写分离功能</li>
</ol>
<h3 id="kubernetes-组件">kubernetes 组件</h3>
<ol class="incremental">
<li>3 种 RC (ReplicationController)</li>
<li>3 种 Service</li>
<li>3 + 1 + 2 个 Pod 实例</li>
</ol>
<h3 id="补充">补充</h3>
<ul class="incremental">
<li>ReplicationController 指定副本数</li>
<li>Service 通过 LabelSelector 选中相应的 pods</li>
<li>Redis-master 的 Service 为后续 Redis-slave Pods 设置了相应的环境变量（redis 主节点地址信息）</li>
</ul>
<h2 id="kubernetes-基本概念和术语">Kubernetes 基本概念和术语</h2>
<h3 id="node">Node</h3>
<ul class="incremental">
<li>也称作 Minion</li>
<li>由　Master 的 Node Controller 进行管理</li>
<li>运行有 kubelet, kube-proxy, docker-daemon</li>
<li>主动注册到 kubernetes 集群</li>
<li>也可有 Master 手动注册</li>
</ul>
<h3 id="pod豆荚">Pod（豆荚）</h3>
<ul class="incremental">
<li>一组容器的集合，作为 Logical Host</li>
<li>封装了 Docker 等容器功能，因为 Docker 的通信方式复杂（Link）</li>
<li>Pod 中的容器共享了 PID, Net, IPC, UTS(主机名), Volume</li>
<li>Pod 中的容器可以直接用 localhost 相互访问（像同一台机器）</li>
<li>Pod 只能运行在单一 Node 上</li>
<li>Pod 有生命周期，由 ReplicationController 管理</li>
</ul>
<h3 id="label">Label</h3>
<ul class="incremental">
<li>Attach key/value pairs to Objects</li>
<li>可以由 LabelSelector 语法来选取（equality 或 set 比较）</li>
<li>RC 和 Service 使用 LabelSelector 来选中副本的 Pods</li>
</ul>
<h3 id="rc-replicationcontroller">RC (ReplicationController)</h3>
<ul class="incremental">
<li>类似于 Yarn ApplicationManager</li>
<li>可以动态修改 Pod 副本数量 <code>kubectl scale rc redis-slave --replicas=3</code></li>
<li>删除 RC 不会自动删除相应的 Pods！</li>
</ul>
<h3 id="service">Service</h3>
<ul class="incremental">
<li>选中一组 Pod，并 Expose 服务</li>
<li>与 Pod 建立 Endpoints 连接？</li>
<li>有多种方式，如 NodePort, LoadBalancer</li>
<li>生成一个稳定的虚拟 IP (相对 Pods 临时地址)</li>
<li>可以映射多端口</li>
</ul>
<h3 id="volume">Volume</h3>
<ul class="incremental">
<li>与 Pod 有相同的生命周期</li>
<li>为 Pod 中的全部 Container 提供服务</li>
<li>有多种实现，常用的有
<ul class="incremental">
<li>emptyDir (临时)</li>
<li>hostPath (不一致)</li>
<li>gccPersistDisk, aws...</li>
<li>nfs</li>
<li>iSCSI</li>
<li>gitRepo</li>
</ul></li>
</ul>
<h3 id="namespace">Namespace</h3>
<ul class="incremental">
<li>将对象逻辑分组</li>
<li>用于多租户管理</li>
</ul>
<h3 id="annotation">Annotation</h3>
<ul class="incremental">
<li>类似于 label</li>
<li>没有 labelSelector 功能</li>
<li>可以存储关联任何格式的数据</li>
</ul>
<h2 id="kubernetes-总体架构">Kubernetes 总体架构</h2>
<p>kubernetes 由三部分构成</p>
<ul class="incremental">
<li>工具集 kubectl</li>
<li>Master
<ul class="incremental">
<li>etcd: Key/value 数据库</li>
<li>Core
<ul class="incremental">
<li>API Server: Restful 服务，提供全量查询和变化监听功能，为 kubectl, controller manager, scheduler, proxy 所用</li>
<li>Controller Manager: 集群管理控制中心，故障检测与自动恢复机制</li>
<li>Scheduler: Pod 到 Node 的调度/Binding</li>
</ul></li>
</ul></li>
<li>Node
<ul class="incremental">
<li>kubelet: 负责 Pod 的创建、维护等生命管理</li>
<li>proxy: Service 代理，起负载均衡作用</li>
</ul></li>
</ul>
<h2 id="kubernetes-安装与配置">Kubernetes 安装与配置</h2>
<ul class="incremental">
<li>描述从二进制文件安装 kubernetes 的方法</li>
<li>分 master 和 node 分别安装和配置</li>
<li>用 systemd 来管理服务的依赖关系</li>
<li>各种服务均需要指定 master api server 地址</li>
<li>提到了在内网搭建私有云？</li>
<li>提到了 Supervisor 在前台执行命令</li>
</ul>
<h1 id="kubernetes-核心原理">Kubernetes 核心原理</h1>
<h2 id="kubernetes-api-server-分析">Kubernetes API Server 分析</h2>
<h3 id="基本功能">基本功能</h3>
<ol class="incremental">
<li>提供 API Interface</li>
<li>各组件的枢纽，etcd 对外接口</li>
<li>安全机制</li>
</ol>
<h3 id="对外端口">对外端口</h3>
<ol class="incremental">
<li>HTTP 8080</li>
<li>SecurePort HTTPs 6443</li>
</ol>
<h3 id="与-api-server-的交互方式">与 API SERVER 的交互方式</h3>
<ol class="incremental">
<li>API (Restful)，路径如 <code>/api/v1/proxy/nodes/{name}/pods</code></li>
<li>Proxy 反向代理 API SERVER</li>
<li>Lanaguage Client Library 封装</li>
<li>kubectl command line （类比于 beeline 之于 hive server2）</li>
</ol>
<h3 id="细节补充">细节补充</h3>
<ul class="incremental">
<li>各模块缓存机制以减少对 apiserver 的压力</li>
<li>node 定时向 apiserver 汇总状态</li>
</ul>
<h2 id="调度控制原理"><span class="todo TODO">TODO</span> 调度控制原理</h2>
<h2 id="kubelet-运行机制分析"><span class="todo TODO">TODO</span> Kubelet 运行机制分析</h2>
<h2 id="安全机制的原理"><span class="todo TODO">TODO</span> 安全机制的原理</h2>
<h2 id="网络原理"><span class="todo TODO">TODO</span> 网络原理</h2>
<h1 id="kubernetes-开发指南"><span class="todo TODO">TODO</span> Kubernetes 开发指南</h1>
<h1 id="kubernetes-运维指南"><span class="todo TODO">TODO</span> Kubernetes 运维指南</h1>
<h1 id="kubernetes-高级案例进阶"><span class="todo TODO">TODO</span> Kubernetes 高级案例进阶</h1>
<h1 id="kubernetes-源码导读"><span class="todo TODO">TODO</span> Kubernetes 源码导读</h1>
<h1 id="问题">问题</h1>
<h2 id="etcd-与-k8s-的关系">etcd 与 k8s 的关系</h2>
<p>etcd 在 Master 节点运行，是一个键值对数据库，保存 k8s 运行对象配置数据</p>
<h2 id="kube-apiserver-kube-controller-manager-kube-scheduler-kubelet-kube-proxy-的关系"><span class="todo TODO">TODO</span> =kube-apiserver=, <code>kube-controller-manager</code>, <code>kube-scheduler</code>, <code>kubelet</code>, <code>kube-proxy</code> 的关系</h2>
<h2 id="service-nodeport"><span class="todo TODO">TODO</span> Service Nodeport</h2>
<h2 id="service-loadbalancer"><span class="todo TODO">TODO</span> Service LoadBalancer</h2>
<h1 id="杂项">杂项</h1>
<ul class="incremental">
<li>etcd 是 kubernetes 运行时需要的数据库</li>
</ul>

				</div>
			</section>
		</body>
	</html>
	