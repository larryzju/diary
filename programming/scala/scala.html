
	<!DOCTYPE html>
	<html>
		<head>
			<title>scala.org</title>
			<link rel="stylesheet" href="/resources/css/main.css" />
			<script src="/resources/js/jquery-3.4.1.min.js"></script>
			<script src="/resources/js/swgen.js"></script>
		</head>
		<body>
			<nav id='content'>
				<ul><li><details><summary>algorithm</summary><ul><li><details><summary>introduction-to-algorithm</summary><ul><li><a href='//algorithm/introduction-to-algorithm/sort.html'>sort.org</a></li></ul></details></li><li><a href='//algorithm/string-match.html'>string-match.org</a></li></ul></details></li><li><details><summary>blog</summary><ul><li><a href='//blog/rescure-libc-deleted.html'>rescure-libc-deleted.org</a></li><li><a href='//blog/timezone.html'>timezone.org</a></li></ul></details></li><li><details><summary>book</summary><ul><li><a href='//book/git%e6%95%99%e7%a8%8b.html'>git教程.org</a></li><li><a href='//book/go%e8%af%ad%e8%a8%80%e7%bc%96%e7%a8%8b.html'>go语言编程.org</a></li><li><a href='//book/javascript%e5%85%a8%e6%a0%88%e6%95%99%e7%a8%8b.html'>javascript全栈教程.org</a></li><li><a href='//book/rich-dad-and-poor-dad.html'>rich-dad-and-poor-dad.org</a></li><li><a href='//book/%e4%ba%ba%e7%b1%bb%e7%ae%80%e5%8f%b2%e2%80%94%e2%80%94%e4%bb%8e%e5%8a%a8%e7%89%a9%e5%88%b0%e4%b8%8a%e5%b8%9d.html'>人类简史——从动物到上帝.org</a></li><li><details><summary>春秋史话</summary><ul><li><a href='//book/%e6%98%a5%e7%a7%8b%e5%8f%b2%e8%af%9d/%e6%98%a5%e7%a7%8b%e5%8f%b2%e8%af%9d.html'>春秋史话.org</a></li></ul></details></li><li><a href='//book/%e8%9a%8a%e5%ad%90%e5%b9%b2%e5%98%9b%e8%80%81%e5%8f%ae%e6%88%91.html'>蚊子干嘛老叮我.org</a></li></ul></details></li><li><details><summary>cloud</summary><ul><li><a href='//cloud/docker.html'>docker.org</a></li><li><a href='//cloud/gcp.html'>gcp.org</a></li><li><a href='//cloud/gke.html'>gke.org</a></li><li><a href='//cloud/helm.html'>helm.org</a></li><li><details><summary>kubernetes</summary><ul><li><a href='//cloud/kubernetes/README.html'>README.org</a></li><li><a href='//cloud/kubernetes/cloudman.html'>cloudman.org</a></li><li><a href='//cloud/kubernetes/content.html'>content.org</a></li><li><a href='//cloud/kubernetes/controller.html'>controller.org</a></li><li><a href='//cloud/kubernetes/golang.html'>golang.org</a></li><li><a href='//cloud/kubernetes/k8s.html'>k8s.org</a></li><li><a href='//cloud/kubernetes/kubeadm.html'>kubeadm.org</a></li><li><a href='//cloud/kubernetes/kuberbuilder.html'>kuberbuilder.org</a></li><li><a href='//cloud/kubernetes/kubernetes-guide.html'>kubernetes-guide.org</a></li><li><a href='//cloud/kubernetes/operator.html'>operator.org</a></li><li><a href='//cloud/kubernetes/rbac.html'>rbac.org</a></li><li><a href='//cloud/kubernetes/registry.html'>registry.org</a></li><li><a href='//cloud/kubernetes/todo.html'>todo.org</a></li><li><a href='//cloud/kubernetes/tutorial.html'>tutorial.org</a></li><li><a href='//cloud/kubernetes/what-is-container.html'>what-is-container.org</a></li></ul></details></li></ul></details></li><li><details><summary>csapp</summary><ul><li><a href='//csapp/csapp-digest.html'>csapp-digest.org</a></li><li><a href='//csapp/cscpp.html'>cscpp.org</a></li></ul></details></li><li><a href='//docker.html'>docker.org</a></li><li><details><summary>emacs</summary><ul><li><a href='//emacs/orgmode.html'>orgmode.org</a></li></ul></details></li><li><details><summary>history</summary><ul><li><a href='//history/%e5%85%a8%e7%90%83%e9%80%9a%e5%8f%b2.html'>全球通史.org</a></li><li><a href='//history/%e5%8d%97%e5%8c%97%e6%9c%9d.html'>南北朝.org</a></li><li><a href='//history/%e6%99%8b%e5%8f%b2.html'>晋史.org</a></li></ul></details></li><li><details><summary>linux</summary><ul><li><a href='//linux/centos.html'>centos.org</a></li><li><a href='//linux/filesystem.html'>filesystem.org</a></li><li><a href='//linux/init.d.html'>init.d.org</a></li><li><a href='//linux/iptables.html'>iptables.org</a></li><li><a href='//linux/linuxcast.html'>linuxcast.org</a></li><li><a href='//linux/ss.html'>ss.org</a></li><li><a href='//linux/suse.html'>suse.org</a></li><li><a href='//linux/vps.html'>vps.org</a></li></ul></details></li><li><details><summary>literal</summary><ul><li><a href='//literal/book.html'>book.org</a></li><li><a href='//literal/han.html'>han.org</a></li><li><a href='//literal/movie.html'>movie.org</a></li><li><a href='//literal/nounce.html'>nounce.org</a></li><li><a href='//literal/person.html'>person.org</a></li><li><a href='//literal/%e5%9f%ba%e7%9d%a3%e5%b1%b1%e4%bc%af%e7%88%b5.html'>基督山伯爵.org</a></li></ul></details></li><li><details><summary>math</summary><ul><li><a href='//math/%e6%a6%82%e7%8e%87%e8%ae%ba%e4%b8%8e%e6%95%b0%e7%90%86%e7%bb%9f%e8%ae%a1.html'>概率论与数理统计.org</a></li></ul></details></li><li><a href='//mindmap.html'>mindmap.org</a></li><li><details><summary>misc</summary><ul><li><a href='//misc/org-usage.html'>org-usage.org</a></li><li><a href='//misc/screen.html'>screen.org</a></li></ul></details></li><li><details><summary>network</summary><ul><li><a href='//network/ssl.html'>ssl.org</a></li></ul></details></li><li><a href='//opengl.html'>opengl.org</a></li><li><a href='//orgmode.html'>orgmode.org</a></li><li><details><summary>os</summary><ul><li><a href='//os/80386.html'>80386.org</a></li><li><a href='//os/8259a.html'>8259a.org</a></li><li><a href='//os/boot.html'>boot.org</a></li><li><a href='//os/gcc-inline-asm.html'>gcc-inline-asm.md</a></li><li><a href='//os/linux.html'>linux.org</a></li></ul></details></li><li><details><summary>policy</summary><ul><li><a href='//policy/%e5%85%a8%e7%90%83%e5%8c%96%e6%b3%a2%e6%8a%98%e4%b8%8e%e6%b0%91%e8%90%a5%e7%bb%8f%e6%b5%8e%e7%9a%84%e6%9c%aa%e6%9d%a5_%e5%91%a8%e5%85%b6%e4%bb%81.html'>全球化波折与民营经济的未来_周其仁.org</a></li></ul></details></li><li><details><summary>programming</summary><ul><li><details><summary>algorithm</summary><ul><li><details><summary>algorithm4th</summary><ul><li><a href='//programming/algorithm/algorithm4th/algorithm.html'>algorithm.org</a></li></ul></details></li><li><a href='//programming/algorithm/%e5%b0%8f%e7%94%b2%e9%b1%bc-%e6%95%b0%e6%8d%ae%e7%bb%93%e6%9e%84%e4%b8%8e%e7%ae%97%e6%b3%95-%e8%a7%86%e9%a2%91%e7%ac%94%e8%ae%b0.html'>小甲鱼-数据结构与算法-视频笔记.org</a></li></ul></details></li><li><details><summary>clojure</summary><ul><li><a href='//programming/clojure/clojure.tools.logging.html'>clojure.tools.logging.md</a></li></ul></details></li><li><details><summary>cpp</summary><ul><li><a href='//programming/cpp/tutorials.html'>tutorials.org</a></li></ul></details></li><li><details><summary>elasticsearch</summary><ul><li><a href='//programming/elasticsearch/elasticsearch-definitive-guide-note.html'>elasticsearch-definitive-guide-note.org</a></li></ul></details></li><li><details><summary>git</summary><ul><li><a href='//programming/git/git.html'>git.org</a></li></ul></details></li><li><details><summary>golang</summary><ul><li><a href='//programming/golang/cmd.html'>cmd.org</a></li><li><a href='//programming/golang/effective-go.html'>effective-go.org</a></li><li><a href='//programming/golang/go-concurrency.html'>go-concurrency.org</a></li><li><a href='//programming/golang/how-to-write-go-code.html'>how-to-write-go-code.org</a></li><li><a href='//programming/golang/json.html'>json.org</a></li><li><details><summary>learn-go-note</summary><ul><li><a href='//programming/golang/learn-go-note/learning-go.html'>learning-go.org</a></li></ul></details></li><li><a href='//programming/golang/library.html'>library.org</a></li><li><a href='//programming/golang/misc.html'>misc.org</a></li><li><a href='//programming/golang/reflect.html'>reflect.org</a></li><li><a href='//programming/golang/template.html'>template.org</a></li><li><a href='//programming/golang/the-little-go-book.html'>the-little-go-book.org</a></li><li><a href='//programming/golang/%e6%97%a0%e9%97%bb%e8%a7%86%e9%a2%91%e7%ac%94%e8%ae%b0.html'>无闻视频笔记.org</a></li></ul></details></li><li><details><summary>hadoop</summary><ul><li><a href='//programming/hadoop/hdfs-permission-guide-note.html'>hdfs-permission-guide-note.org</a></li></ul></details></li><li><details><summary>java</summary><ul><li><a href='//programming/java/derby.html'>derby.org</a></li><li><a href='//programming/java/ivy-vs-maven.html'>ivy-vs-maven.org</a></li><li><a href='//programming/java/java-note.html'>java-note.org</a></li><li><a href='//programming/java/maven.html'>maven.org</a></li><li><a href='//programming/java/servlet.html'>servlet.org</a></li><li><a href='//programming/java/thing-java.html'>thing-java.org</a></li><li><a href='//programming/java/%e6%b7%b1%e5%85%a5%e7%90%86%e8%a7%a3java%e8%99%9a%e6%8b%9f%e6%9c%ba.html'>深入理解java虚拟机.org</a></li></ul></details></li><li><details><summary>javascript</summary><ul><li><a href='//programming/javascript/angularjs.html'>angularjs.org</a></li><li><a href='//programming/javascript/dom.html'>dom.org</a></li></ul></details></li><li><a href='//programming/javascript.html'>javascript.org</a></li><li><details><summary>lisp</summary><ul><li><a href='//programming/lisp/the-little-schemer.html'>the-little-schemer.org</a></li></ul></details></li><li><details><summary>python</summary><ul><li><a href='//programming/python/asyncio.html'>asyncio.org</a></li><li><a href='//programming/python/flask.html'>flask.org</a></li><li><a href='//programming/python/idiomatic-python-note.html'>idiomatic-python-note.org</a></li><li><a href='//programming/python/jinja2.html'>jinja2.org</a></li><li><a href='//programming/python/package-manage.html'>package-manage.org</a></li><li><a href='//programming/python/pygame.html'>pygame.org</a></li><li><a href='//programming/python/tools.html'>tools.org</a></li></ul></details></li><li><details><summary>scala</summary><ul><li><a href='//programming/scala/programming-in-scala.html'>programming-in-scala.org</a></li><li><a href='//programming/scala/scala.html'>scala.org</a></li><li><a href='//programming/scala/scalikeJDBC.html'>scalikeJDBC.org</a></li></ul></details></li><li><a href='//programming/storm.html'>storm.org</a></li><li><a href='//programming/thrift.html'>thrift.org</a></li><li><a href='//programming/typescript.html'>typescript.org</a></li><li><details><summary>web</summary><ul><li><a href='//programming/web/liquid.html'>liquid.org</a></li></ul></details></li></ul></details></li><li><details><summary>rdbms</summary><ul><li><a href='//rdbms/rdbms.html'>rdbms.org</a></li></ul></details></li><li><details><summary>resource</summary><ul><li><a href='//resource/emacs.html'>emacs.md</a></li><li><a href='//resource/ml-resource.html'>ml-resource.md</a></li><li><a href='//resource/nlp-resource.html'>nlp-resource.md</a></li></ul></details></li><li><details><summary>services</summary><ul><li><details><summary>mail</summary><ul><li><a href='//services/mail/mail.html'>mail.org</a></li></ul></details></li></ul></details></li><li><details><summary>subtitle</summary><ul><li><a href='//subtitle/docker.html'>docker.org</a></li></ul></details></li><li><details><summary>toarous</summary><ul><li><a href='//toarous/README.html'>README.md</a></li><li><a href='//toarous/idt.html'>idt.md</a></li><li><a href='//toarous/intel.html'>intel.org</a></li><li><a href='//toarous/notes.html'>notes.org</a></li><li><a href='//toarous/osx-environment.html'>osx-environment.org</a></li><li><a href='//toarous/vga.html'>vga.md</a></li></ul></details></li><li><details><summary>tools</summary><ul><li><a href='//tools/GCP.html'>GCP.org</a></li><li><a href='//tools/ansible.html'>ansible.org</a></li><li><a href='//tools/bash.html'>bash.org</a></li><li><a href='//tools/gerrit.html'>gerrit.org</a></li><li><a href='//tools/git.html'>git.org</a></li><li><a href='//tools/gpg.html'>gpg.org</a></li><li><a href='//tools/markdown.html'>markdown.org</a></li><li><a href='//tools/nginx.html'>nginx.org</a></li><li><a href='//tools/rpm.html'>rpm.org</a></li><li><a href='//tools/spark.html'>spark.org</a></li><li><a href='//tools/tmux.html'>tmux.org</a></li></ul></details></li><li><details><summary>ui</summary><ul><li><a href='//ui/react.html'>react.org</a></li><li><a href='//ui/tk.html'>tk.org</a></li></ul></details></li><li><details><summary>web</summary><ul><li><a href='//web/chrome-extension.html'>chrome-extension.org</a></li></ul></details></li><li><a href='//words.html'>words.org</a></li><li><a href='//%e7%bd%91%e6%b0%91%e7%9a%84%e7%8b%82%e6%ac%a2.html'>网民的狂欢.org</a></li></ul>
			</nav>
			<section class="main-article-area">
				<div id='main'>
					<h1 id="collection">Collection</h1>
<h2 id="说明">说明</h2>
<p>scala 官方 tutorial 第一章中重点介绍了集合类的特性：</p>
<ul class="incremental">
<li>通用性</li>
<li>一致性</li>
<li>功能丰富性</li>
</ul>
<p>类似于 clojure 等设计思路</p>
<ul class="incremental">
<li>对集合作出抽象数据结构，有丰富的通用的 API 和函数式的用法</li>
<li>使用高阶函数（并提供语法支持）</li>
<li>方便在 API 兼容的情况下切换到多处理器支持等不同实现数据结构</li>
</ul>
<p>优于 clojure 的地方在于</p>
<ul class="incremental">
<li>scala 是静态类型语言，通过函数参数显式声明，在编译时会检测出很多类型错误</li>
</ul>
<h2 id="可变与不可变">可变与不可变</h2>
<p>集合类存在三种变体：</p>
<ul class="incremental">
<li>root: <code>scala.collection</code></li>
<li>mutable: <code>scala.collection.mutable</code></li>
<li>immutable: <code>scala.collection.immutable</code></li>
</ul>
<p>为了方便和向后兼容性，一些导入类型在包 <code>scala</code> 中有别名，如： <code>List</code>, <code>Traversable</code>, <code>Iterable</code>, <code>Seq</code>, <code>IndexedSeq</code>, <code>Iterator</code>, <code>Stream</code>, <code>Vector</code>, <code>StringBuilder</code>, <code>Range</code></p>
<h3 id="scala.collection-数据结构层次">scala.collection 数据结构层次</h3>
<p><img src="image/collections.png" /></p>
<p>集合类的抽象层次依次为：</p>
<ol class="incremental">
<li>Traverable</li>
<li>Iterable</li>
<li>Seq, Set, Map</li>
<li>...</li>
</ol>
<h3 id="scala.collection.immutable-数据结构层次">scala.collection.immutable 数据结构层次</h3>
<p><img src="image/collections.immutable.png" /></p>
<h3 id="scala.collection.mutable-数据结构层次">scala.collection.mutable 数据结构层次</h3>
<p><img src="image/collections.mutable.png" /></p>
<h3 id="构造">构造</h3>
<p>直接用类型加参数列表构造，常见语法如</p>
<ul class="incremental">
<li><code>Traversable(1,2,3)</code></li>
<li><code>Map(&quot;x&quot;-&gt;24,&quot;y&quot;-&gt;25,&quot;z&quot;-&gt;26)</code></li>
</ul>
<h3 id="api">API</h3>
<ul class="incremental">
<li>Traversable 类提供了所有集合支持的 API</li>
<li>可能被具体类型实现重写</li>
<li>map 操作返回与原类型一致的对象</li>
</ul>
<h2 id="常用不可变类型">常用不可变类型</h2>
<table>
<thead>
<tr class="header">
<th>名称</th>
<th>说明</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>ArrayBuffer</td>
<td>底层是 array，隐含 size，向结尾添加高效</td>
</tr>
<tr class="even">
<td>ListBuffer</td>
<td>内部为 linked list</td>
</tr>
<tr class="odd">
<td>StringBuilder</td>
<td>用于构造 String，可以直接在 scala 命名空间使用</td>
</tr>
<tr class="even">
<td>LinkedList</td>
<td>单向链表，用于方便插入</td>
</tr>
<tr class="odd">
<td>DoubleLinkedList</td>
<td>双向链表</td>
</tr>
<tr class="even">
<td>MutableList</td>
<td>单向链表+尾指针，append 效率高，是 LineSeq 的标准实现</td>
</tr>
<tr class="odd">
<td>Queue</td>
<td>用 <code>+=</code> 添加元素， <code>++=</code> 添加 seq</td>
</tr>
<tr class="even">
<td>ArraySeq</td>
<td></td>
</tr>
<tr class="odd">
<td>Stack</td>
<td></td>
</tr>
<tr class="even">
<td>ArrayStack</td>
<td></td>
</tr>
<tr class="odd">
<td>HashMap/HashSet</td>
<td>底层是数组，返回时按哈希顺序返回</td>
</tr>
<tr class="even">
<td>WeakHashMap</td>
<td>无引用会自动删除键值对，用作缓存（类似 clojure memorize），底层是 <code>java.util.WeakHashMap</code></td>
</tr>
<tr class="odd">
<td>ConcurrentMap</td>
<td>有额外带保护的方法，是 trait，实现了 <code>java.util.concurrent.ConcurrentMap</code></td>
</tr>
<tr class="even">
<td>BitSet</td>
<td></td>
</tr>
</tbody>
</table>
<h3 id="empty-构造"><span class="todo TODO">TODO</span> empty 构造</h3>
<p>可以用 <code>mutable.ArrayBuffer.empty[int]</code> 构造对象，empty 的 API 从哪里来？</p>
<h3 id="linearseq-类型">LinearSeq 类型</h3>
<p>LinearSeq 底层是 MutableList，那么 LinearSeq 本质上是个 class 还是 type?</p>
<h1 id="string-interpolation">String Interpolation</h1>
<p>String Interpolation 是在 2.10.0 中加入的功能，可以在字符串中嵌入变量引用，如 =s&quot;Hello, $name&quot;=</p>
<p>内置三种前缀字母，表示不同的处理方法：</p>
<ol class="incremental">
<li>s 前缀，类似 ruby，替换用 <code>$var</code> 表示的变量，也可将表达式放在 <code>${}</code> 中</li>
<li>f 前缀，类似 printf 语法，如 =f&quot;$name%s is $height%2.2f meters tall&quot;=</li>
<li>raw 前缀，类似 python 'r' 前缀，同 's'，但不会处理转义字符</li>
</ol>
<p>String Interpolation 本质上是语法糖，对应于 <code>StringContext.id</code> 函数调用，可以自定义，需要实现一个 implicit 类，方法略</p>
<h1 id="repl">REPL</h1>
<p>scala repl 将代码按模板进行封装（wrap with template)，编译并执行。并将结果自动导出到当前 scope 中。</p>
<p>常用的命令有</p>
<table>
<thead>
<tr class="header">
<th>variable/command</th>
<th>description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>$intp</td>
<td>IMain 实例</td>
</tr>
<tr class="even">
<td>lastException</td>
<td>最后一个异常</td>
</tr>
<tr class="odd">
<td>:help</td>
<td>查看帮助</td>
</tr>
<tr class="even">
<td>:javap</td>
<td>反汇编文件或类</td>
</tr>
<tr class="odd">
<td>:power</td>
<td>进入 power mode</td>
</tr>
<tr class="even">
<td>&lt;tab&gt;</td>
<td>补全</td>
</tr>
</tbody>
</table>
<h1 id="trait">trait</h1>
<h2 id="概述">概述</h2>
<p>trait 类似 java 的 interface，用于定义类的方法模板。</p>
<h2 id="继承inherit与混成mixin">继承(inherit)与混成(mixin)</h2>
<p>mixin 类比于电影中合成技术（混成），对于两个相同规格的场景（基础类），混成出一个全新的场景（extends ... with）。</p>
<p>trait 可以扩展(extends) 抽象类，实现扩展的方法。并在同样继承(inherit) 抽象类的类中，混成 trait 扩展的方法。</p>
<p>优点在于，将扩展的通用实现加入到朴素的原始数据结构中。</p>
<p>如：</p>
<pre class="example"><code>abstract class AbsIterator {
  type T
  def hasNext: Boolean
  def next: T
}

trait RichIterator extends AbsIterator {
  def foreach( f: T =&gt; Unit ) { while ( hasNext ) f(next) }
}

class StringIterator( s: String ) extends AbsIterator {
  type T = Char
  private var i = 0
  def hasNext = i &lt; s.length()
  def next  = { val ch = s charAt i; i += 1; ch }
}

object StringIteratorTest {
  def main( args: Array[String] ) {
    class Iter extends StringIterator( args(0) ) with RichIterator
    val iter = new Iter
    iter foreach println
  }
}
</code></pre>
<h2 id="注意事项">注意事项</h2>
<ul class="incremental">
<li>trait 不能有构造函数</li>
<li>定义的函数可以是抽象的，也可以是具体的</li>
<li>具体的函数可以依赖于抽象函数</li>
</ul>

				</div>
			</section>
		</body>
	</html>
	