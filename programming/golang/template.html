<!DOCTYPE html>
<html>
	<head>
		<title>template.org</title>
		<link rel="stylesheet" href="/diary/resources/css/main.css" />
		<link rel="stylesheet" href="/diary/resources/highlight/styles/default.css" />
		<script src="/diary/resources/js/jquery-3.4.1.min.js"></script>
		<script src="/diary/resources/js/swgen.js"></script>
		<script src="/diary/resources/highlight/highlight.pack.js"></script>
		<script src='https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/latest.js?config=TeX-MML-AM_CHTML' async></script>
		<script>hljs.initHighlightingOnLoad();</script>
	</head>
	<body>
		<nav id='content'>
		</nav>
		<section class="main-article-area">
			<div id='main'>
				<h1 id="overview">Overview</h1>
<p>Template can evaluate with runtime variables to generate output.</p>
<p>Go provides <code>text/template</code> and <code>html/template</code>. The later contains protections for code injections.</p>
<p>Can be used in scenarios like</p>
<ol class="incremental">
<li>web page render (similar to jekyll's liquid, or hugo)</li>
<li>email</li>
<li>kubectl (wow, actually said k8s used <a href="https://github.com/spf13/cobra">cobra</a>)</li>
</ol>
<h1 id="usage">Usage</h1>
<ol class="incremental">
<li>create a new template object</li>
<li>parse from template files or strings</li>
<li>execute the template upon runtime context to generate output</li>
</ol>
<h1 id="example">Example</h1>
<div class="sourceCode" id="cb1"><pre class="sourceCode go"><code class="sourceCode go"><span id="cb1-1"><a href="#cb1-1"></a><span class="kw">package</span> main</span>
<span id="cb1-2"><a href="#cb1-2"></a></span>
<span id="cb1-3"><a href="#cb1-3"></a><span class="kw">import</span>(</span>
<span id="cb1-4"><a href="#cb1-4"></a>        <span class="st">&quot;html/template&quot;</span></span>
<span id="cb1-5"><a href="#cb1-5"></a>        <span class="st">&quot;os&quot;</span></span>
<span id="cb1-6"><a href="#cb1-6"></a>)</span>
<span id="cb1-7"><a href="#cb1-7"></a></span>
<span id="cb1-8"><a href="#cb1-8"></a><span class="kw">type</span> entry <span class="kw">struct</span> {</span>
<span id="cb1-9"><a href="#cb1-9"></a>        N <span class="dt">int</span></span>
<span id="cb1-10"><a href="#cb1-10"></a>        V <span class="dt">uint64</span></span>
<span id="cb1-11"><a href="#cb1-11"></a>}</span>
<span id="cb1-12"><a href="#cb1-12"></a></span>
<span id="cb1-13"><a href="#cb1-13"></a><span class="kw">const</span> tmpl = <span class="st">`</span></span>
<span id="cb1-14"><a href="#cb1-14"></a><span class="st">&lt;html&gt;</span></span>
<span id="cb1-15"><a href="#cb1-15"></a><span class="st">  &lt;table&gt;</span></span>
<span id="cb1-16"><a href="#cb1-16"></a><span class="st">    &lt;tr&gt;</span></span>
<span id="cb1-17"><a href="#cb1-17"></a><span class="st">      &lt;th&gt;n&lt;/th&gt;</span></span>
<span id="cb1-18"><a href="#cb1-18"></a><span class="st">      &lt;th&gt;fib(n)&lt;/th&gt;</span></span>
<span id="cb1-19"><a href="#cb1-19"></a><span class="st">    &lt;tr&gt;</span></span>
<span id="cb1-20"><a href="#cb1-20"></a><span class="st">    {{range .}}</span></span>
<span id="cb1-21"><a href="#cb1-21"></a><span class="st">    &lt;tr&gt;</span></span>
<span id="cb1-22"><a href="#cb1-22"></a><span class="st">      &lt;td&gt;{{.N}}&lt;/td&gt;</span></span>
<span id="cb1-23"><a href="#cb1-23"></a><span class="st">      &lt;td&gt;{{.V}}&lt;/td&gt;</span></span>
<span id="cb1-24"><a href="#cb1-24"></a><span class="st">    &lt;/tr&gt;</span></span>
<span id="cb1-25"><a href="#cb1-25"></a><span class="st">    {{end}}</span></span>
<span id="cb1-26"><a href="#cb1-26"></a><span class="st">  &lt;/table&gt;</span></span>
<span id="cb1-27"><a href="#cb1-27"></a><span class="st">&lt;/html&gt;</span></span>
<span id="cb1-28"><a href="#cb1-28"></a><span class="st">`</span></span>
<span id="cb1-29"><a href="#cb1-29"></a></span>
<span id="cb1-30"><a href="#cb1-30"></a><span class="kw">func</span> main() {</span>
<span id="cb1-31"><a href="#cb1-31"></a>        v := []entry{}</span>
<span id="cb1-32"><a href="#cb1-32"></a>        <span class="kw">var</span> s, b <span class="dt">uint64</span> = <span class="dv">0</span>, <span class="dv">1</span></span>
<span id="cb1-33"><a href="#cb1-33"></a>        <span class="kw">for</span> i := <span class="dv">0</span>; i &lt; <span class="dv">30</span>; i++ {</span>
<span id="cb1-34"><a href="#cb1-34"></a>                s, b = b, s+b</span>
<span id="cb1-35"><a href="#cb1-35"></a>                v = <span class="bu">append</span>(v, entry{i+<span class="dv">1</span>,s})</span>
<span id="cb1-36"><a href="#cb1-36"></a>        }</span>
<span id="cb1-37"><a href="#cb1-37"></a></span>
<span id="cb1-38"><a href="#cb1-38"></a>        t := template.Must(template.New(<span class="st">&quot;fib&quot;</span>).Parse(tmpl))</span>
<span id="cb1-39"><a href="#cb1-39"></a>        t.Execute( os.Stdout, v )</span>
<span id="cb1-40"><a href="#cb1-40"></a>}</span></code></pre></div>
<h1 id="syntax">Syntax</h1>
<p>Only <code>{{ action }}</code> will be evaluated and substituted.</p>
<p>The basic syntax are</p>
<ol class="incremental">
<li>data evaluation <code>{{.FieldName}}</code> for struct field visits or <code>{{.}}</code> for non-struct</li>
<li>conditions: <code>{{if .FieldName}} //action {{else}} //action2 {{end}}</code></li>
<li>loops: <code>{{ range .Member }} ... {{ end }}</code></li>
<li>functions, pipelines and variables: <code>|</code> or <code>with</code></li>
</ol>
<h1 id="misc">Misc</h1>
<dl class="incremental">
<dt><code>Must</code></dt>
<dd>verify and panic when error happens
</dd>
<dt><code>ParseFiles</code></dt>
<dd>parse multiple files
</dd>
<dt><code>ParseGlob</code></dt>
<dd>parse globbed files
</dd>
</dl>
<h1 id="todo"><span class="todo TODO">TODO</span> TODO</h1>
<h2 id="how-to-use-multiple-files-template">how to use multiple files template</h2>
<h2 id="cobra">Cobra</h2>

			</div>
		</section>
	</body>
</html>
