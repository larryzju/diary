<!DOCTYPE html>
<html lang="en">
<head>
<!-- 2017-06-10 Sat 23:36 -->
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>Note on "Code Like a Pythonista: Idiomatic Python"</title>
<meta name="generator" content="Org mode">
<meta name="author" content="Zhao WenBin">
<style type="text/css">
 <!--/*--><![CDATA[/*><!--*/
  .title  { text-align: center;
             margin-bottom: .2em; }
  .subtitle { text-align: center;
              font-size: medium;
              font-weight: bold;
              margin-top:0; }
  .todo   { font-family: monospace; color: red; }
  .done   { font-family: monospace; color: green; }
  .priority { font-family: monospace; color: orange; }
  .tag    { background-color: #eee; font-family: monospace;
            padding: 2px; font-size: 80%; font-weight: normal; }
  .timestamp { color: #bebebe; }
  .timestamp-kwd { color: #5f9ea0; }
  .org-right  { margin-left: auto; margin-right: 0px;  text-align: right; }
  .org-left   { margin-left: 0px;  margin-right: auto; text-align: left; }
  .org-center { margin-left: auto; margin-right: auto; text-align: center; }
  .underline { text-decoration: underline; }
  #postamble p, #preamble p { font-size: 90%; margin: .2em; }
  p.verse { margin-left: 3%; }
  pre {
    border: 1px solid #ccc;
    box-shadow: 3px 3px 3px #eee;
    padding: 8pt;
    font-family: monospace;
    overflow: auto;
    margin: 1.2em;
  }
  pre.src {
    position: relative;
    overflow: visible;
    padding-top: 1.2em;
  }
  pre.src:before {
    display: none;
    position: absolute;
    background-color: white;
    top: -10px;
    right: 10px;
    padding: 3px;
    border: 1px solid black;
  }
  pre.src:hover:before { display: inline;}
  /* Languages per Org manual */
  pre.src-asymptote:before { content: 'Asymptote'; }
  pre.src-awk:before { content: 'Awk'; }
  pre.src-C:before { content: 'C'; }
  /* pre.src-C++ doesn't work in CSS */
  pre.src-clojure:before { content: 'Clojure'; }
  pre.src-css:before { content: 'CSS'; }
  pre.src-D:before { content: 'D'; }
  pre.src-ditaa:before { content: 'ditaa'; }
  pre.src-dot:before { content: 'Graphviz'; }
  pre.src-calc:before { content: 'Emacs Calc'; }
  pre.src-emacs-lisp:before { content: 'Emacs Lisp'; }
  pre.src-fortran:before { content: 'Fortran'; }
  pre.src-gnuplot:before { content: 'gnuplot'; }
  pre.src-haskell:before { content: 'Haskell'; }
  pre.src-java:before { content: 'Java'; }
  pre.src-js:before { content: 'Javascript'; }
  pre.src-latex:before { content: 'LaTeX'; }
  pre.src-ledger:before { content: 'Ledger'; }
  pre.src-lisp:before { content: 'Lisp'; }
  pre.src-lilypond:before { content: 'Lilypond'; }
  pre.src-lua:before { content: 'Lua'; }
  pre.src-matlab:before { content: 'MATLAB'; }
  pre.src-mscgen:before { content: 'Mscgen'; }
  pre.src-ocaml:before { content: 'Objective Caml'; }
  pre.src-octave:before { content: 'Octave'; }
  pre.src-org:before { content: 'Org mode'; }
  pre.src-oz:before { content: 'OZ'; }
  pre.src-plantuml:before { content: 'Plantuml'; }
  pre.src-processing:before { content: 'Processing.js'; }
  pre.src-python:before { content: 'Python'; }
  pre.src-R:before { content: 'R'; }
  pre.src-ruby:before { content: 'Ruby'; }
  pre.src-sass:before { content: 'Sass'; }
  pre.src-scheme:before { content: 'Scheme'; }
  pre.src-screen:before { content: 'Gnu Screen'; }
  pre.src-sed:before { content: 'Sed'; }
  pre.src-sh:before { content: 'shell'; }
  pre.src-sql:before { content: 'SQL'; }
  pre.src-sqlite:before { content: 'SQLite'; }
  /* additional languages in org.el's org-babel-load-languages alist */
  pre.src-forth:before { content: 'Forth'; }
  pre.src-io:before { content: 'IO'; }
  pre.src-J:before { content: 'J'; }
  pre.src-makefile:before { content: 'Makefile'; }
  pre.src-maxima:before { content: 'Maxima'; }
  pre.src-perl:before { content: 'Perl'; }
  pre.src-picolisp:before { content: 'Pico Lisp'; }
  pre.src-scala:before { content: 'Scala'; }
  pre.src-shell:before { content: 'Shell Script'; }
  pre.src-ebnf2ps:before { content: 'ebfn2ps'; }
  /* additional language identifiers per "defun org-babel-execute"
       in ob-*.el */
  pre.src-cpp:before  { content: 'C++'; }
  pre.src-abc:before  { content: 'ABC'; }
  pre.src-coq:before  { content: 'Coq'; }
  pre.src-groovy:before  { content: 'Groovy'; }
  /* additional language identifiers from org-babel-shell-names in
     ob-shell.el: ob-shell is the only babel language using a lambda to put
     the execution function name together. */
  pre.src-bash:before  { content: 'bash'; }
  pre.src-csh:before  { content: 'csh'; }
  pre.src-ash:before  { content: 'ash'; }
  pre.src-dash:before  { content: 'dash'; }
  pre.src-ksh:before  { content: 'ksh'; }
  pre.src-mksh:before  { content: 'mksh'; }
  pre.src-posh:before  { content: 'posh'; }
  /* Additional Emacs modes also supported by the LaTeX listings package */
  pre.src-ada:before { content: 'Ada'; }
  pre.src-asm:before { content: 'Assembler'; }
  pre.src-caml:before { content: 'Caml'; }
  pre.src-delphi:before { content: 'Delphi'; }
  pre.src-html:before { content: 'HTML'; }
  pre.src-idl:before { content: 'IDL'; }
  pre.src-mercury:before { content: 'Mercury'; }
  pre.src-metapost:before { content: 'MetaPost'; }
  pre.src-modula-2:before { content: 'Modula-2'; }
  pre.src-pascal:before { content: 'Pascal'; }
  pre.src-ps:before { content: 'PostScript'; }
  pre.src-prolog:before { content: 'Prolog'; }
  pre.src-simula:before { content: 'Simula'; }
  pre.src-tcl:before { content: 'tcl'; }
  pre.src-tex:before { content: 'TeX'; }
  pre.src-plain-tex:before { content: 'Plain TeX'; }
  pre.src-verilog:before { content: 'Verilog'; }
  pre.src-vhdl:before { content: 'VHDL'; }
  pre.src-xml:before { content: 'XML'; }
  pre.src-nxml:before { content: 'XML'; }
  /* add a generic configuration mode; LaTeX export needs an additional
     (add-to-list 'org-latex-listings-langs '(conf " ")) in .emacs */
  pre.src-conf:before { content: 'Configuration File'; }

  table { border-collapse:collapse; }
  caption.t-above { caption-side: top; }
  caption.t-bottom { caption-side: bottom; }
  td, th { vertical-align:top;  }
  th.org-right  { text-align: center;  }
  th.org-left   { text-align: center;   }
  th.org-center { text-align: center; }
  td.org-right  { text-align: right;  }
  td.org-left   { text-align: left;   }
  td.org-center { text-align: center; }
  dt { font-weight: bold; }
  .footpara { display: inline; }
  .footdef  { margin-bottom: 1em; }
  .figure { padding: 1em; }
  .figure p { text-align: center; }
  .inlinetask {
    padding: 10px;
    border: 2px solid gray;
    margin: 10px;
    background: #ffffcc;
  }
  #org-div-home-and-up
   { text-align: right; font-size: 70%; white-space: nowrap; }
  textarea { overflow-x: auto; }
  .linenr { font-size: smaller }
  .code-highlighted { background-color: #ffff00; }
  .org-info-js_info-navigation { border-style: none; }
  #org-info-js_console-label
    { font-size: 10px; font-weight: bold; white-space: nowrap; }
  .org-info-js_search-highlight
    { background-color: #ffff00; color: #000000; font-weight: bold; }
  .org-svg { width: 90%; }
  /*]]>*/-->
</style>
<link rel="stylesheet" type="text/css" href="/diary/style/style.css"/>
<script type="text/javascript">
/*
@licstart  The following is the entire license notice for the
JavaScript code in this tag.

Copyright (C) 2012-2017 Free Software Foundation, Inc.

The JavaScript code in this tag is free software: you can
redistribute it and/or modify it under the terms of the GNU
General Public License (GNU GPL) as published by the Free Software
Foundation, either version 3 of the License, or (at your option)
any later version.  The code is distributed WITHOUT ANY WARRANTY;
without even the implied warranty of MERCHANTABILITY or FITNESS
FOR A PARTICULAR PURPOSE.  See the GNU GPL for more details.

As additional permission under GNU GPL version 3 section 7, you
may distribute non-source (e.g., minimized or compacted) forms of
that code without the copy of the GNU GPL normally required by
section 4, provided you include this license notice and a URL
through which recipients can access the Corresponding Source.


@licend  The above is the entire license notice
for the JavaScript code in this tag.
*/
<!--/*--><![CDATA[/*><!--*/
 function CodeHighlightOn(elem, id)
 {
   var target = document.getElementById(id);
   if(null != target) {
     elem.cacheClassElem = elem.className;
     elem.cacheClassTarget = target.className;
     target.className = "code-highlighted";
     elem.className   = "code-highlighted";
   }
 }
 function CodeHighlightOff(elem, id)
 {
   var target = document.getElementById(id);
   if(elem.cacheClassElem)
     elem.className = elem.cacheClassElem;
   if(elem.cacheClassTarget)
     target.className = elem.cacheClassTarget;
 }
/*]]>*///-->
</script>
</head>
<body>
<div id="content">
<header>
<h1 class="title">Note on "Code Like a Pythonista: Idiomatic Python"</h1>
</header>
<div id="outline-container-orgce705be" class="outline-2">
<h2 id="orgce705be">说明</h2>
<div class="outline-text-2" id="text-orgce705be">
<p>
笔记摘录自 <a href="http://python.net/~goodger/projects/pycon/2007/idiomatic/handout.html#simple-is-better-than-complex">Code Like a Pythonista: Idiomatic Python</a>
</p>
</div>
</div>

<div id="outline-container-orgecb1f38" class="outline-2">
<h2 id="orgecb1f38">Zen of Python</h2>
<div class="outline-text-2" id="text-orgecb1f38">
<p>
使用 <code>import this</code> 来查看 python zen, 在 PEP20 中正式定义
</p>


<pre class="example">
The Zen of Python, by Tim Peters

Beautiful is better than ugly.
Explicit is better than implicit.
Simple is better than complex.
Complex is better than complicated.
Flat is better than nested.
Sparse is better than dense.
Readability counts.
Special cases aren't special enough to break the rules.
Although practicality beats purity.
Errors should never pass silently.
Unless explicitly silenced.
In the face of ambiguity, refuse the temptation to guess.
There should be one-- and preferably only one --obvious way to do it.
Although that way may not be obvious at first unless you're Dutch.
Now is better than never.
Although never is often better than *right* now.
If the implementation is hard to explain, it's a bad idea.
If the implementation is easy to explain, it may be a good idea.
Namespaces are one honking great idea -- let's do more of those!
</pre>
</div>

<div id="outline-container-org569f0e2" class="outline-3">
<h3 id="org569f0e2">心得</h3>
<div class="outline-text-3" id="text-org569f0e2">
<ul class="org-ul">
<li>大巧不工</li>
<li>道可道，非常道</li>
<li>不要隐藏问题，尽快解决，至少让它能及时反映出来</li>
<li>不要过度追求代码的完善，完成功能是首要的</li>
<li>要有原则，有所不为，过多的特例只会成为惯例</li>
</ul>
</div>
</div>
</div>


<div id="outline-container-org85c3803" class="outline-2">
<h2 id="org85c3803">Coding Style</h2>
<div class="outline-text-2" id="text-org85c3803">
<blockquote>
<p>
Programms must be written for people to read, and only incidentally for machines to execute. &#x2013; SICP
</p>
</blockquote>

<p>
Python 推荐的编码风格参考 PEP08
</p>
</div>


<div id="outline-container-org06b8bf1" class="outline-3">
<h3 id="org06b8bf1">Whitespace</h3>
<div class="outline-text-3" id="text-org06b8bf1">
<ul class="org-ul">
<li>4 个空格缩进</li>
<li>不要混合 tabs 和 spaces</li>
<li>函数间以一个空行分隔</li>
<li>Class 前加两个空行</li>
<li>在 dict, list, tuple 中逗号分隔后加空格；同理，在 dict 的冒号后加空格</li>
<li>在赋值或比较前后加空格分隔</li>
<li>圆括号前后不要加空格</li>
</ul>
</div>
</div>

<div id="outline-container-orgc308dd1" class="outline-3">
<h3 id="orgc308dd1">命名</h3>
<div class="outline-text-3" id="text-orgc308dd1">
<ul class="org-ul">
<li>下划线命名</li>
<li>大写用于常量</li>
<li>类名用骆驼命名法</li>
<li>使用 <code>_name</code> 表示私有变量，不要用两个下划线开头</li>
<li>python 中以两个下划线开头的变量，实际上被展开成为 <code>_ClassName__PrivateName</code></li>
</ul>
</div>
</div>

<div id="outline-container-orge88c22d" class="outline-3">
<h3 id="orge88c22d">Long Lines &amp; Continuations</h3>
<div class="outline-text-3" id="text-orge88c22d">
<ul class="org-ul">
<li>保持一行 80 个字符</li>
<li>括号内部可以直接换行</li>
<li>其余场景需要以反斜线和换行（反斜线前不要加空格）</li>
</ul>
</div>
</div>

<div id="outline-container-orgc7bf3e2" class="outline-3">
<h3 id="orgc7bf3e2">Long Strings</h3>
<div class="outline-text-3" id="text-orgc7bf3e2">
<ul class="org-ul">
<li>多个字符串用在解释时被拼接，如 <code>print 'o' 'n' 'e'</code></li>
<li>字符串前缀以 'r' 表示 raw string, 其中的反斜转义失效，可以用于写正则式</li>
<li><p>
三引号内可以换行，但首行需要加反斜线来去掉空行，如
</p>
<div class="org-src-container">
<pre class="src src-python">'''\
Triple
single
quotes\
'''
</pre>
</div></li>
</ul>
</div>
</div>

<div id="outline-container-org93ad5d1" class="outline-3">
<h3 id="org93ad5d1">Compound Statements</h3>
<div class="outline-text-3" id="text-org93ad5d1">
<ul class="org-ul">
<li>虽然可以将 if 或 while 的 statement 写在一行</li>
<li>但是最好还是按规则分开来写</li>
<li>Multiple statements on one line are a cardinal sin.</li>
</ul>
</div>
</div>

<div id="outline-container-org8bc8b21" class="outline-3">
<h3 id="org8bc8b21">Docstrings &amp; Comments</h3>
<div class="outline-text-3" id="text-org8bc8b21">
<ul class="org-ul">
<li>docstring 用于说明如何使用</li>
<li>comments 用于解释为何和怎样实现的</li>
<li>False comments &amp; docstrings are worse than none at all.</li>
<li>参考 PEP257 "Docstring Conventions"</li>
</ul>
</div>
</div>
</div>




<div id="outline-container-orge430e8d" class="outline-2">
<h2 id="orge430e8d">Practicality vs Purity</h2>
<div class="outline-text-2" id="text-orge430e8d">
<p>
打破纯净的场景如
</p>

<ol class="org-ol">
<li>纯净性使代码完全不可读</li>
<li>与历史上的问题等纠结一起</li>
</ol>
</div>
</div>

<div id="outline-container-org4230909" class="outline-2">
<h2 id="org4230909">范式</h2>
<div class="outline-text-2" id="text-org4230909">
</div><div id="outline-container-orgc545da5" class="outline-3">
<h3 id="orgc545da5">Swap Values</h3>
<div class="outline-text-3" id="text-orgc545da5">
</div><div id="outline-container-org1a36dd0" class="outline-4">
<h4 id="org1a36dd0">例子</h4>
<div class="outline-text-4" id="text-org1a36dd0">
<div class="org-src-container">
<pre class="src src-python">b, a = a, b
</pre>
</div>
</div>
</div>

<div id="outline-container-orge4e8fa3" class="outline-4">
<h4 id="orge4e8fa3">说明</h4>
<div class="outline-text-4" id="text-orge4e8fa3">
<ul class="org-ul">
<li>右侧为 Tuple 的构造形式</li>
<li>赋值的同时进行解构（destructure），类似于 Clojure</li>
<li>解构可以对嵌套结构进行</li>
</ul>
</div>
</div>
</div>




<div id="outline-container-org53928c1" class="outline-3">
<h3 id="org53928c1">More About Tuples</h3>
<div class="outline-text-3" id="text-org53928c1">
<ul class="org-ul">
<li><code>1,</code> 生成一个 Tuple <code>(1,)</code></li>
<li>最好用括号显式表示: <code>(1,)</code></li>
<li>如果忘记了逗号，则生成一个数字 <code>(1)</code></li>
<li>空的 Tuple 使用 <code>()</code> 或 <code>tuple()</code> 来构造</li>
</ul>
</div>
</div>


<div id="outline-container-org35676ae" class="outline-3">
<h3 id="org35676ae">Interactive "_"</h3>
<div class="outline-text-3" id="text-org35676ae">
<ul class="org-ul">
<li>交互解析时，"_" 保存上次计算的结果</li>
</ul>
</div>
</div>


<div id="outline-container-orgd71b434" class="outline-3">
<h3 id="orgd71b434">Building Strings from Substrings</h3>
<div class="outline-text-3" id="text-orgd71b434">
<ul class="org-ul">
<li>使用 <code>result = ''.join(colors)</code></li>
<li>不要使用 for 循环往字符串后追加</li>
</ul>
</div>
</div>

<div id="outline-container-orgd0ca5ab" class="outline-3">
<h3 id="orgd0ca5ab">Use <code>in</code> where possible</h3>
<div class="outline-text-3" id="text-orgd0ca5ab">
<ul class="org-ul">
<li>用于循环取迭代器中的元素，效率高</li>
<li>对于 dictionary 直接用 in，不要用 <code>for key in d.keys()</code></li>
<li><code>in</code> 也可以用于判断元素是否在集合中</li>
</ul>
</div>
</div>


<div id="outline-container-orge518980" class="outline-3">
<h3 id="orge518980">Dictionary <code>get</code> Method</h3>
<div class="outline-text-3" id="text-orge518980">
<p>
经常用有需要聚合统计，将结果保存在 dict 中。
</p>

<p>
下面两种方法，第二种更好：
</p>

<div class="org-src-container">
<pre class="src src-python"># naive
navs = {}
for ( portfolio, equity, position ) in data:
    if portfolio not in navs:
	navs[portfolio] = 0
    navs[portfolio] += position * prices[equity]


# better
navs = {}
for ( position, equity, position ) in data:
    navs[position] = (navs.get(portfolio,0) + position * prices[equity])
</pre>
</div>
</div>
</div>
<div id="outline-container-org048a0a3" class="outline-3">
<h3 id="org048a0a3">Dictionary <code>setdefault</code> Method</h3>
<div class="outline-text-3" id="text-org048a0a3">
<p>
会有需要将集合中的元素按关键字进行分组，牵扯到为相应的键生成一个空的 list 
</p>
</div>

<div id="outline-container-org647084d" class="outline-4">
<h4 id="org647084d">示例</h4>
<div class="outline-text-4" id="text-org647084d">
<p>
不好的方法是
</p>

<div class="org-src-container">
<pre class="src src-python">equities = {}
for ( portfolio, equility ) in data:
    if portfolio in equility:
	equility[portfolio].append( equility )
    else:
	equility[portfolio] = [equity]
</pre>
</div>

<p>
比较好的方式是使用 <code>dict.setdefault(key, default)</code> ，如下
</p>

<div class="org-src-container">
<pre class="src src-python">equities = {}
for ( portfolio, equity ) in data:
    equities.setdefault( portfolio, [] ).append( equity )
</pre>
</div>
</div>
</div>

<div id="outline-container-org2091d24" class="outline-4">
<h4 id="org2091d24">说明</h4>
<div class="outline-text-4" id="text-org2091d24">
<ul class="org-ul">
<li><code>setdefault( key, default )</code> 进行 get 或先 set 后 get</li>
<li>只有在 key 不存在时都会设置 default</li>
<li>但每次都会重新对 default 进行求值</li>
</ul>
</div>
</div>


<div id="outline-container-orgc1e75a0" class="outline-4">
<h4 id="orgc1e75a0">defaultdict</h4>
<div class="outline-text-4" id="text-orgc1e75a0">
</div><ul class="org-ul"><li><a id="org03032f9"></a>说明<br><div class="outline-text-5" id="text-org03032f9">
<ul class="org-ul">
<li>在 <code>collections.defaultdict</code> 定义</li>
<li>加入了默认的工厂函数</li>
<li>在对一个不存在的键作操作时，会调用 factory function 来进行初始化</li>
</ul>
</div></li>

<li><a id="orgf212040"></a>示例<br><div class="outline-text-5" id="text-orgf212040">
<div class="org-src-container">
<pre class="src src-python">from collctions import defaultdict

equities = defaultdict(list)
for ( portfolio, equity ) in data:
    equities[portfolio].append( equity )

navs = defaultdict(int)
for ( portfolio, equity, position ) in data:
    navs[portfolio] += position * prices[equity]
</pre>
</div>
</div></li></ul>
</div>
</div>
<div id="outline-container-org75b84c3" class="outline-3">
<h3 id="org75b84c3">Building &amp; Splitting Dictionaries</h3>
<div class="outline-text-3" id="text-org75b84c3">
<ul class="org-ul">
<li>使用 zip 将 key list 和 value list 生成一个 dict</li>
<li>dict 的 key 是无序的，但是一但生成顺序不会变</li>
</ul>
</div>
</div>
<div id="outline-container-orgf9bd113" class="outline-3">
<h3 id="orgf9bd113">Testing for Truth Values</h3>
<div class="outline-text-3" id="text-orgf9bd113">
<ul class="org-ul">
<li>测试是否为真，使用 <code>if x:</code> 而不要使用 <code>if x == True</code></li>
<li>测试是否为空，使用 <code>if itemsL</code> 而不要使用 <code>len(items) != 0</code> 或 <code>items != []</code></li>
</ul>
</div>
</div>
<div id="outline-container-orga66149d" class="outline-3">
<h3 id="orga66149d">Truth Values</h3>
<div class="outline-text-3" id="text-orga66149d">
</div><div id="outline-container-org13663d6" class="outline-4">
<h4 id="org13663d6">基本类型</h4>
<div class="outline-text-4" id="text-org13663d6">
<p>
Python 中为 False 的值包括
</p>

<ul class="org-ul">
<li>False</li>
<li>""</li>
<li>0, 0.0</li>
<li>[], (), {}, set()</li>
<li>None</li>
</ul>

<p>
除此外都是 True
</p>
</div>
</div>




<div id="outline-container-orgf4695f1" class="outline-4">
<h4 id="orgf4695f1">自定义类型</h4>
<div class="outline-text-4" id="text-orgf4695f1">
<ul class="org-ul">
<li>容器类，定义 <code>__len__</code> 表示长度</li>
<li>非窗口类，定义 <code>__nonzero__</code> 表示是否为真</li>
<li>python3.0 中 <code>__nonzero__</code> 被重命名为 <code>__bool__</code></li>
</ul>
</div>
</div>
</div>


<div id="outline-container-orgb4ce7b3" class="outline-3">
<h3 id="orgb4ce7b3">Index &amp; Item</h3>
<div class="outline-text-3" id="text-orgb4ce7b3">
<ul class="org-ul">
<li>使用 enumerate 函数来迭代 list，同时获取 index 和 item</li>
<li>enumerate 返回迭代器，会惰性求值，称为 generator</li>
</ul>
</div>
</div>

<div id="outline-container-org12e41a7" class="outline-3">
<h3 id="org12e41a7">Other language have "variables"</h3>
<div class="outline-text-3" id="text-org12e41a7">
<ul class="org-ul">
<li>Python 的动态类型语言</li>
<li>变量名称（atom）实际只是一个指针</li>
<li>指向的对象（object）本身有类型</li>
<li>当变量（object）没有被引用时，将在未来被回收内存</li>
<li>In Python, "variables" are nametags for values, not labelled boxes.</li>
</ul>
</div>
</div>




<div id="outline-container-org2b92269" class="outline-3">
<h3 id="org2b92269">Default Parameter Values</h3>
<div class="outline-text-3" id="text-org2b92269">
</div><div id="outline-container-orged28a38" class="outline-4">
<h4 id="orged28a38">例子</h4>
<div class="outline-text-4" id="text-orged28a38">
<div class="org-src-container">
<pre class="src src-python">def bad_append( new_item, a_list=[] ):
    a_list.append( new_item )
    return a_list

print bad_append( "one" )
print bad_append( "two" )
</pre>
</div>
</div>
</div>


<div id="outline-container-orge2d199b" class="outline-4">
<h4 id="orge2d199b">说明</h4>
<div class="outline-text-4" id="text-orge2d199b">
<ul class="org-ul">
<li>函数的参数的默认值在函数定义处被调用</li>
<li>每次函数调用中使用的 <code>a_list</code> 都是同一个</li>
</ul>
</div>
</div>

<div id="outline-container-org0cdf7ac" class="outline-4">
<h4 id="org0cdf7ac">修改方法</h4>
<div class="outline-text-4" id="text-org0cdf7ac">
<div class="org-src-container">
<pre class="src src-python">def good_append( new_item, a_list=None ):
    if a_list is None:
	a_list = []
    a_list.append( new_item )
    return a_list
</pre>
</div>
</div>
</div>
</div>


<div id="outline-container-orgaf6c476" class="outline-3">
<h3 id="orgaf6c476">String Formatting</h3>
<div class="outline-text-3" id="text-orgaf6c476">
<ul class="org-ul">
<li>python 的 <code>%</code> 操作类似于 C 的 <code>sprintf</code></li>
<li>参考 <i>Python Library Reference</i>, section 2.3.6.2 "String Formatting Operations"</li>
</ul>
</div>
</div>

<div id="outline-container-org3c3b438" class="outline-3">
<h3 id="org3c3b438">Advanced String Formatting</h3>
<div class="outline-text-3" id="text-org3c3b438">
</div><div id="outline-container-org2d00f73" class="outline-4">
<h4 id="org2d00f73">interpolation</h4>
<div class="outline-text-4" id="text-org2d00f73">
<p>
可以使用 interpolation 机制来生成（注意安全）
</p>

<div class="org-src-container">
<pre class="src src-python">values = {name': name, 'messages': messages}
print ('Hello %(name)s, you have %(message)i messages' % values)

## or 
print ('Hello %(name)s, you have %(message)i messages' % locals())
</pre>
</div>
</div>
</div>
<div id="outline-container-org255e99c" class="outline-4">
<h4 id="org255e99c">object's instances attributes</h4>
<div class="outline-text-4" id="text-org255e99c">
<ul class="org-ul">
<li>使用 <code>self.__dict__</code> 来将类对象的成员生成一个dict</li>
<li>可以用于生成格式化字符结果</li>
</ul>
</div>
</div>
</div>

<div id="outline-container-org406cf92" class="outline-3">
<h3 id="org406cf92">List Comprehensions</h3>
<div class="outline-text-3" id="text-org406cf92">
<ul class="org-ul">
<li>简称 listcomps</li>
<li>如 <code>[fn(item) for item in a_list if condition(item)]</code></li>
<li>更简洁更清晰</li>
<li>不宜过多的层级生成</li>
</ul>
</div>
</div>


<div id="outline-container-org55c535d" class="outline-3">
<h3 id="org55c535d">Generator Expression</h3>
<div class="outline-text-3" id="text-org55c535d">
</div><div id="outline-container-orgc18d7d1" class="outline-4">
<h4 id="orgc18d7d1">例子</h4>
<div class="outline-text-4" id="text-orgc18d7d1">
<div class="org-src-container">
<pre class="src src-python">print sum([num*num for num in range(1,101)])
print sum( num*num for num in range(1,101))

# more
month_codes = dict((fn(i+1), code)
  for i, code in enumerate( 'FGHJKMNQUVXZ' )
  for fn in (int, str))
</pre>
</div>
</div>
</div>

<div id="outline-container-orgc7f1dce" class="outline-4">
<h4 id="orgc7f1dce">说明</h4>
<div class="outline-text-4" id="text-orgc7f1dce">
<ul class="org-ul">
<li>简称 genexps</li>
<li>类似于 list comprehensions</li>
<li>不同之处在于 listcomps 是贪婪的，一次求值</li>
<li>generator 是惰性的，适合于处理长的序列</li>
<li>这里最好配合 <code>xrange</code> 使用</li>
</ul>
</div>
</div>
</div>




<div id="outline-container-orga396d28" class="outline-3">
<h3 id="orga396d28">Sorting</h3>
<div class="outline-text-3" id="text-orga396d28">
<ul class="org-ul">
<li><code>list.sort()</code> 在原数组上排序</li>
<li>可以指定排序方法 cmp, 可以比较慢</li>
<li>更好的方法是指定 key 方法</li>
</ul>
</div>
</div>





<div id="outline-container-org22f5b6a" class="outline-3">
<h3 id="org22f5b6a">Generators</h3>
<div class="outline-text-3" id="text-org22f5b6a">
<ul class="org-ul">
<li><code>yield</code> 将一个函数变成一个 generator</li>
<li>generator 函数返回一个 generator object</li>
<li>其中实现了迭代器需要的 next 方法（并以 <code>StopIteration</code> 异常为结束）</li>
<li>generator function 用维护迭代过程的状态</li>
<li>配合 for 使用</li>
<li>for 可以有一个 <code>else</code> 从句，在正常结束（非 break）时被调用</li>
</ul>
</div>
</div>





<div id="outline-container-org7c614a7" class="outline-3">
<h3 id="org7c614a7">EAFP vs. LBYL</h3>
<div class="outline-text-3" id="text-org7c614a7">
<ul class="org-ul">
<li>EAFP: easier to ask forgiveness than permission</li>
<li>LBYL: look before you leap</li>
<li>鸭子类型： If it walks like a duck, and talks like a duck, and looks like a duck: It's a duck</li>
<li>可以在对类型有要求的地方使用异常处理保护</li>
<li>不要直接捕 <code>except</code> 异常，而只针对期望的异常</li>
</ul>
</div>
</div>

<div id="outline-container-org5c002a3" class="outline-3">
<h3 id="org5c002a3">import</h3>
<div class="outline-text-3" id="text-org5c002a3">
<ul class="org-ul">
<li>不要使用 <code>from module import *</code></li>
<li>这将污染 namespace 环境</li>
<li>可以通过起别名、显式导入方式来解决</li>
</ul>
</div>
</div>


<div id="outline-container-orgd406451" class="outline-3">
<h3 id="orgd406451">Modules &amp; Scripts</h3>
<div class="outline-text-3" id="text-orgd406451">
<ul class="org-ul">
<li><code>if __name__ == '__main__':</code> 来保存可执行语句</li>
<li>被导入时， <code>__name__</code> 被设置成模块的名称，因此不会执行</li>
<li>当直接运行时， <code>__name__</code> 被设置成 "<span class="underline"><span class="underline">main</span></span>"</li>
</ul>
</div>
</div>


<div id="outline-container-org774a754" class="outline-3">
<h3 id="org774a754">Module Structure</h3>
<div class="outline-text-3" id="text-org774a754">
<pre class="example">
"""module docstring"""

# imports
# constants
# exception classes
# interface functions
# classes
# internal functions &amp; classes 

def main(...):
    ...

if __name__ == "__main__":
    status = main()
    sys.exit( status )
</pre>
</div>
</div>
<div id="outline-container-org5c1650e" class="outline-3">
<h3 id="org5c1650e">Packages</h3>
<div class="outline-text-3" id="text-org5c1650e">
</div><div id="outline-container-org926b31f" class="outline-4">
<h4 id="org926b31f">目录结构</h4>
<div class="outline-text-4" id="text-org926b31f">
<pre class="example">
package/
    __init__.py
    module1.py
    subpackage/
	__init__.py
	module2.py
</pre>
</div>
</div>


<div id="outline-container-org42c4793" class="outline-4">
<h4 id="org42c4793">使用方式</h4>
<div class="outline-text-4" id="text-org42c4793">
<div class="org-src-container">
<pre class="src src-python">import package.module1
from package.subpackage import module2
from package.subpackage.module2 import name
</pre>
</div>
</div>
</div>
</div>
</div>
<div id="outline-container-org0376c11" class="outline-2">
<h2 id="org0376c11">Simple is Better Than Complex</h2>
<div class="outline-text-2" id="text-org0376c11">
<blockquote>
<p>
Debugging is twice as hard as writing the code in the first place. Therefore, if you write the code as cleverly as possible, you are, by definition, not smart enough to debug it.
</p>
</blockquote>
</div>

<div id="outline-container-org4c8c556" class="outline-3">
<h3 id="org4c8c556">原则</h3>
<div class="outline-text-3" id="text-org4c8c556">
<ul class="org-ul">
<li>keep you programs simple</li>
<li>don't reinvent the wheel
<ul class="org-ul">
<li>check python's standard library.</li>
<li>check the python package index ( pip )</li>
<li>search the web.</li>
</ul></li>
</ul>
</div>
</div>
</div>
</div>
<div id="postamble" class="status">
<p class="author">Author: Zhao WenBin</p>
<p class="date">Created: 2017-06-10 Sat 23:36</p>
<p class="validation"><a href="http://validator.w3.org/check?uri=referer">Validate</a></p>
</div>
</body>
</html>
