<!DOCTYPE html>
<html>
	<head>
		<title>ssl.org</title>
		<link rel="stylesheet" href="/diary/_resources/css/main.css" />
		<script src="/diary/_resources/js/jquery-3.4.1.min.js"></script>
		<script src="/diary/_resources/js/swgen.js"></script>
	</head>
	<body>
		<nav id='content'>
		</nav>
		<section class="main-article-area">
			<div id='main'>
				<h1 id="overview">Overview</h1>
<p>SSL/TLS protocol usually builds upon TCP protocol and serves encryption to higher layers (say HTTPs).</p>
<p>Before the message can be transport in encryption way, client and server need to exchange informations to each other. These steps are called <strong>handshake</strong>.</p>
<p>Both side encrypt messages with <strong>master secret</strong> which consist of client and server's 32bytes random number, plus 48bytes <code>PreMasterSecret</code> generated in ClientKeyExchange phase.</p>
<p>Note: SSL use the asymmetric encryption to deliver the shared session key (pre master secret), and finally archieved a communication way with <strong>symmetric</strong> encryption (with master secret). That is because the symmetric encryption is much faster.</p>
<h1 id="basic-handshake-steps">Basic Handshake Steps</h1>
<h2 id="clienthello">ClientHello</h2>
<p>Client sends <strong>ClientHello</strong> message specifying</p>
<ul class="incremental">
<li>TLS protocol version it supports</li>
<li>random number (32bytes)</li>
<li>set of cipher suites it supports</li>
<li>set of compression methods it supports</li>
</ul>
<h2 id="serverhello">ServerHello</h2>
<p>Server reposonses <strong>ServerHello</strong> and tells client</p>
<ul class="incremental">
<li>which protocol version to use</li>
<li>server random number (32bytes)</li>
<li>set of cipher suites it supports</li>
<li>set of compression methods it supports</li>
</ul>
<h2 id="server-certificate">Server Certificate</h2>
<p>Server send its <strong>certificate</strong> to client which is used for encrypt <code>PreMasterSecret</code></p>
<h2 id="serverhellodone">ServerHelloDone</h2>
<h2 id="clientkeyexchange">ClientKeyExchange</h2>
<p>Client generates <code>PreMasterSecret</code> and encrypts with server's public key</p>
<h2 id="client-changecipherspec">Client ChangeCipherSpec</h2>
<p>From now, messages that client tells with server will be authenticated.</p>
<h2 id="client-finished">Client Finished</h2>
<h2 id="server-changecipherspec">Server ChangeCipherSpec</h2>
<p>From now, messages that server tells with client will be authenticated.</p>
<h2 id="server-finished">Server Finished</h2>
<h1 id="what-is-certificate-content-in-pem-file">What is certificate content in PEM file</h1>
<p>See <a href="https://serverfault.com/questions/9708/what-is-a-pem-file-and-how-does-it-differ-from-other-openssl-generated-key-file">What is a Pem file and how does it differ from other OpenSSL Generated Key File Formats?</a></p>
<h1 id="how-does-ca-verify-signed-certificate">How does CA verify signed certificate?</h1>
<p>It's impossible to exchange public key of all servers we need to visit. So in the handshake, the server will deliver its public key (certificate) to client (browser). Client needs to make sure the public key is really from the server.</p>
<p>So, besides the certificate, the server will send its digital certificate signed by some CA. Browser will ask CA to verify the certificate is real. CA itself may be verified by its signed certificate authorization (so the CA is called intermediate CA).</p>
<p>See external links:</p>
<ul class="incremental">
<li><a href="https://security.stackexchange.com/questions/56389/ssl-certificate-framework-101-how-does-the-browser-actually-verify-the-validity">how does the browser actually verify the validity</a></li>
<li><a href="http://security.stackexchange.com/questions/20803/how-does-ssl-tls-work">How does SSL/TLS work?</a></li>
</ul>

			</div>
		</section>
	</body>
</html>
